CREATE DATABASE IF NOT EXISTS islevilla;

use islevilla;
/*
TABLE刪除順序：被關聯最多的TABLE最晚刪除
其他（最先刪除）
員工
購物
接駁
訂房
會員（最後刪除）
*/

-- 其他
DROP TABLE IF EXISTS chat_message;               -- 聊天訊息
DROP TABLE IF EXISTS chat_room;                  -- 聊天室
DROP TABLE IF EXISTS feedback;                   -- 問卷紀錄
DROP TABLE IF EXISTS news;                       -- 最新消息
DROP TABLE IF EXISTS carousel_photo;             -- 輪播圖片
-- 員工
DROP TABLE IF EXISTS employee_permission;        -- 員工權限對應
DROP TABLE IF EXISTS permission;                 -- 權限
DROP TABLE IF EXISTS operation_log;              -- 操作日誌
DROP TABLE IF EXISTS employee;                   -- 員工
DROP TABLE IF EXISTS department;                 -- 部門
-- 購物
DROP TABLE IF EXISTS product_order_detail;       -- 商品訂單明細
DROP TABLE IF EXISTS product_order;              -- 商品訂單
DROP TABLE IF EXISTS product_photo;              -- 商品圖片
DROP TABLE IF EXISTS cart;                       -- 購物車
DROP TABLE IF EXISTS product;                    -- 商品
DROP TABLE IF EXISTS member_coupon;              -- 會員優惠券對應
DROP TABLE IF EXISTS coupon;                     -- 優惠券
DROP TABLE IF EXISTS product_category;           -- 商品種類
-- 接駁
DROP TABLE IF EXISTS temp_shuttle_reservation_request; -- 臨時接駁預約請求表
DROP TABLE IF EXISTS shuttle_reservation_seat;   -- 接駁預約座位
DROP TABLE IF EXISTS shuttle_reservation;        -- 接駁預約
DROP TABLE IF EXISTS shuttle_seat_availability;  -- 各接駁班次座位剩餘量
DROP TABLE IF EXISTS shuttle_schedule;           -- 接駁班次
DROP TABLE IF EXISTS seat;                       -- 座位
-- 訂房
DROP TABLE IF EXISTS room_reservation_detail;    -- 訂房明細
DROP TABLE IF EXISTS room_reservation_order;     -- 訂房訂單
DROP TABLE IF EXISTS room_promotion_price;       -- 房型優惠價格
DROP TABLE IF EXISTS promotion;                  -- 優惠專案清單
DROP TABLE IF EXISTS room;                       -- 房間
DROP TABLE IF EXISTS room_type_photo;            -- 房型圖片
DROP TABLE IF EXISTS room_type_availability;     -- 各房型空房庫存量
DROP TABLE IF EXISTS room_type;                  -- 房型
-- 會員
DROP TABLE IF EXISTS members;                    -- 會員


/***************************************************************************************************
********************************************* 會員相關 *********************************************
***************************************************************************************************/


-- 會員 members （賴彥儒）
CREATE TABLE members (
	member_id				INT				AUTO_INCREMENT,												-- 會員編號 (PK)
    member_email			VARCHAR(100)	NOT NULL	UNIQUE,											-- 會員信箱 (UNIQLE)
    member_password_hash	VARCHAR(128)	NOT NULL,													-- 會員雜湊密碼
    member_name				VARCHAR(30)		NOT NULL,													-- 會員姓名
    member_birthdate		DATE			NOT NULL,													-- 會員生日
    member_gender			TINYINT			NOT NULL	COMMENT '0:男生 1:女生 2:其它',					-- 會員性別
    member_phone			VARCHAR(20)		NOT NULL	UNIQUE,											-- 會員電話
    member_address			VARCHAR(200)	NOT NULL,													-- 會員地址
    member_photo			LONGBLOB,																	-- 會員照片
    member_created_at		DATETIME		NOT NULL,													-- 會員建立日期
    member_updated_at		DATETIME		NOT NULL,													-- 會員更新日期
    member_last_login_time	DATETIME		NOT NULL,													-- 會員最後登入時間
    member_status			TINYINT			NOT NULL	DEFAULT 0	COMMENT '0:未驗證 1:已驗證 2:停用',	-- 會員狀態
    CONSTRAINT pk_member_id PRIMARY KEY (member_id)
);

INSERT INTO members (member_email, member_password_hash, member_name,  member_birthdate,  member_gender,
					 member_phone, member_address,       member_photo, member_created_at, member_updated_at, member_last_login_time, member_status)
VALUES ('cja101groupsix+01@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '王小明', '1997-03-05', 0, '0900000001', '台北市信義路100號3樓之一', NULL, '2023-07-01 10:15:30', '2025-04-10 14:20:00', '2025-05-19 18:45:10', 1),
	   ('cja101groupsix+02@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '林小華', '1998-03-05', 1, '0900000002', '台中市西屯路88號',         NULL, '2023-07-15 08:30:00', '2025-04-11 09:15:00', '2025-05-19 12:00:00', 1),
	   ('cja101groupsix+03@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '陳大文', '1999-03-05', 0, '0900000003', '高雄市中山路99號',         NULL, '2023-08-01 16:45:00', '2025-04-12 19:30:00', '2025-05-19 21:10:00', 1),
	   ('cja101groupsix+04@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '張怡君', '2000-03-05', 1, '0900000004', '新竹市經國路66號',         NULL, '2023-08-15 11:00:00', '2025-04-13 13:20:00', '2024-05-19 17:55:00', 1),
	   ('cja101groupsix+05@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '周志強', '2001-03-05', 0, '0900000005', '桃園市復興路10號',         NULL, '2023-09-01 09:00:00', '2025-04-14 10:30:00', '2025-05-19 15:40:00', 1),
	   ('cja101groupsix+06@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '蔡美麗', '2002-03-05', 0, '0900000006', '台南市永康區中正街5號',    NULL, '2023-09-15 07:50:00', '2025-04-15 08:30:00', '2025-05-19 20:00:00', 1),
	   ('cja101groupsix+07@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '何玉芬', '2003-03-05', 0, '0900000007', '台北市大安區光復南路11號', NULL, '2023-10-01 14:10:00', '2025-04-16 16:45:00', '2025-05-19 18:15:00', 1),
	   ('cja101groupsix+08@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '黃金龍', '2004-03-05', 1, '0900000008', '嘉義市博愛路3段77號',      NULL, '2023-10-15 18:00:00', '2025-04-17 19:20:00', '2025-05-19 22:30:00', 1),
	   ('cja101groupsix+09@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '劉阿成', '2005-03-05', 1, '0900000009', '台中市南區建國南路20號',   NULL, '2023-11-01 12:15:00', '2025-04-18 13:10:00', '2025-05-19 14:55:00', 0),
	   ('cja101groupsix+10@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '楊淑惠', '2006-03-05', 1, '0900000010', '基隆市安樂區文德路88號',   NULL, '2023-11-15 09:05:00', '2024-04-19 11:30:00', '2025-05-19 16:45:00', 0),
	   ('cja101groupsix+11@gmail.com', '$argon2i$v=19$m=65536,t=3,p=1$Zi9GtJ8A1kAbFRInjhIofg$1p4djCm5PXCC650dGk+z0vKc7JX/LlhY0dRJ79FDMHo', -- 密碼：asd123456
        '測試用', '1912-01-01', 0, '0900000011', '台北市信義路100號3樓之二', NULL, '2023-07-01 10:15:30', '2025-04-20 14:30:00', '2025-05-19 18:46:10', 1);

-- DROP TABLE IF EXISTS members;


/***************************************************************************************************
********************************************* 訂房相關 *********************************************
***************************************************************************************************/


-- 優惠專案清單 promotion （曾宸瑩）
CREATE TABLE promotion (
	room_promotion_id     INT           AUTO_INCREMENT  PRIMARY KEY,  -- 優惠專案編號 (PK)
	room_promotion_title  VARCHAR(20)   NOT NULL,                     -- 優惠專案名稱
	promotion_start_date  DATE          NOT NULL,                     -- 專案開始日期
	promotion_end_date    DATE          NOT NULL,                     -- 專案結束日期
	promotion_remark      VARCHAR(50),                                -- 專案備註
	CONSTRAINT promotion_date_check CHECK (promotion_end_date >= promotion_start_date)  -- 檢查日期
);

INSERT INTO promotion (room_promotion_title, promotion_start_date, promotion_end_date, promotion_remark)
VALUES ('春假專案',     '2025-03-10', '2025-03-20', '適合學生出遊'),
       ('暑期優惠',     '2025-07-01', '2025-08-31', '指定房型享 85 折優惠'),
       ('週末快閃特惠', '2025-09-06', '2025-09-08', '僅限週末住房'),
       ('限時快閃',     '2025-09-15', '2025-09-17', '限時兩天，先搶先贏'),
       ('早鳥優惠',     '2025-10-01', '2025-10-15', '提前預訂享雙人房 75 折'),
       ('中秋促銷',     '2025-10-03', '2025-10-06', '歡慶中秋佳節海景房型優惠中'),
       ('秋季放鬆行程', '2025-10-20', '2025-10-31', '享受秋天悠閒時光'),
       ('週年活動',     '2025-11-01', '2025-11-10', '慶祝微嶼週年'),
       ('聖誕禮物',     '2025-12-24', '2025-12-26', '聖誕節高價位房型回饋價'),
       ('元旦開年優惠', '2026-01-01', '2026-01-07', '開年住宿折扣');

-- DROP TABLE IF EXISTS promotion;


-- 訂房訂單 room_reservation_order （陳薇淨）
CREATE TABLE room_reservation_order (
	room_reservation_id		INT				AUTO_INCREMENT,                                                       		-- 訂房編號 (PK) (AI)
    member_id				INT				NOT NULL,                                                             		-- 會員編號 (FK)
    room_order_date			DATETIME		NOT NULL,                                                             		-- 訂單日期
    room_order_status		TINYINT			NOT NULL  DEFAULT 0  COMMENT '0:成立 1:已入住 2:已退房 3:申請取消 4:確認取消',	-- 訂單狀態
    check_in_date			DATE			NOT NULL,                                                             		-- 入住日期
    actual_check_in_date	DATETIME,                                                             						-- 實際入住時間
    check_out_date			DATE			NOT NULL,                                                             		-- 退房日期
    actual_check_out_date	DATETIME,                                                             						-- 實際退房日期
    room_promotion_id		INT,                                                                                		-- 優惠專案編號 (FK)
    rv_remark				VARCHAR(100),                                                                       		-- 訂房備註
    room_total_amount		INT				NOT NULL,                                                             		-- 訂房總金額
    rv_discount_amount		INT				NOT NULL,                                                             		-- 折扣金額
    rv_paid_amount			INT				NOT NULL,                                                             		-- 實際付款金額
	cancel_reason			VARCHAR(100),																				-- 訂單取消理由
    CONSTRAINT pk_room_reservation_id	PRIMARY KEY(room_reservation_id),
    CONSTRAINT fk_rro_member_id			FOREIGN KEY(member_id) REFERENCES members(member_id),
    CONSTRAINT fk_rro_room_promotion_id	FOREIGN KEY(room_promotion_id) REFERENCES promotion(room_promotion_id)
);

INSERT INTO room_reservation_order (
    member_id, room_order_date, room_order_status, check_in_date, 
    actual_check_in_date, check_out_date, actual_check_out_date, 
    room_promotion_id, rv_remark, room_total_amount, rv_discount_amount, rv_paid_amount
) VALUES 

-- 訂單1: 會員1, 春假專案, 2天1夜, 標準雙人房 (2人)
(1, '2025-03-08 14:30:00', 2, '2025-03-12', '2025-03-12 15:30:00', '2025-03-13', '2025-03-13 11:00:00', 
 1, NULL, 10800, 4320, 6480),

-- 訂單2: 會員2, 暑期優惠, 3天2夜, 豪華海景雙人房+豪華家庭房 (10人)
(2, '2025-06-15 10:20:00', 0, '2025-07-15', NULL, '2025-07-17', NULL, 
 2, '需要嬰兒床一張，謝謝。', 57600, 8640, 48960),
 
-- 訂單3: 會員1, 暑期優惠, 2天1夜, 標準雙人房 (2人)
(1, '2025-06-28 14:30:00', 0, '2025-07-05', NULL, '2025-07-06', NULL, 
 2, NULL, 10800, 1620, 9180),

-- 訂單4: 會員2, 暑期優惠, 3天2夜, 豪華海景雙人房+豪華家庭房 (10人)
(2, '2025-07-01 10:20:00', 0, '2025-07-15', NULL, '2025-07-17', NULL, 
 2, NULL, 57600, 8640, 48960),

-- 訂單5: 會員3, 暑期優惠, 2天1夜, 豪華海景雙人房 (2人)
(3, '2025-07-03 16:45:00', 0, '2025-07-20', NULL, '2025-07-21', NULL, 
 2, NULL, 14400, 2160, 12240),

-- 訂單6: 會員4, 暑期優惠, 3天2夜, 豪華家庭房 (8人)
(4, '2025-07-05 20:10:00', 0, '2025-07-25', NULL, '2025-07-27', NULL, 
 2, NULL, 43200, 6480, 36720),

-- 訂單7: 會員5, 暑期優惠, 4天3夜, 豪華海景家庭房 (16人)
(5, '2025-07-08 11:30:00', 0, '2025-07-12', NULL, '2025-07-15', NULL, 
 2, NULL, 54000, 8100, 45900),

-- 訂單8: 會員6, 無優惠專案, 2天1夜, 標準雙人房 (2人)
(6, '2025-07-10 13:15:00', 0, '2025-07-28', NULL, '2025-07-29', NULL, 
 NULL, NULL, 10800, 0, 10800),

-- 訂單9: 會員7, 暑期優惠, 2天1夜, 豪華海景雙人房 (2人)
(7, '2025-07-12 09:40:00', 0, '2025-07-30', NULL, '2025-07-31', NULL, 
 2, NULL, 14400, 2160, 12240),

-- 訂單10: 會員8, 暑期優惠, 4天3夜, 標準雙人房+豪華家庭房 (12人)
(8, '2025-07-15 17:20:00', 0, '2025-07-22', NULL, '2025-07-25', NULL, 
 2, NULL, 97200, 14580, 82620),

-- 訂單11: 會員1, 無優惠專案, 2天1夜, 豪華海景家庭房 (4人)
(1, '2025-07-18 12:50:00', 0, '2025-07-26', NULL, '2025-07-27', NULL, 
 NULL, NULL, 18000, 0, 18000),

-- 訂單12: 會員10, 暑期優惠, 3天2夜, 豪華海景雙人房 (4人)
(2, '2025-07-20 15:25:00', 0, '2025-07-29', NULL, '2025-07-31', NULL, 
 2, NULL, 28800, 4320, 24480),

-- 訂單13: 會員3, 週末快閃特惠, 2天1夜, 標準雙人房 (2人)
(3, '2025-09-05 16:45:00', 0, '2025-09-07', NULL, '2025-09-08', NULL, 
 3, NULL, 10800, 1080, 9720),

-- 訂單14: 會員4, 限時快閃, 2天1夜, 標準雙人房 (2人)
(4, '2025-09-14 20:10:00', 0, '2025-09-16', NULL, '2025-09-17', NULL, 
 4, '請提供兩張單人被。', 10800, 3240, 7560),

-- 訂單15: 會員5, 早鳥優惠, 3天2夜, 豪華海景雙人房 (6人)
(5, '2025-09-20 11:30:00', 0, '2025-10-10', NULL, '2025-10-12', NULL, 
 5, '有長輩同行，盡量安排近電梯的房間。', 28800, 7200, 21600),

-- 訂單16: 會員6, 中秋促銷, 4天3夜, 海景樓中樓家庭房 (24人)
(6, '2025-10-01 13:15:00', 0, '2025-10-04', NULL, '2025-10-06', NULL, 
 6, NULL, 75600, 11340, 64260),

-- 訂單17: 會員7, 秋季放鬆行程, 2天1夜, 豪華家庭房 (4人)
(7, '2025-10-18 09:40:00', 0, '2025-10-25', NULL, '2025-10-26', NULL, 
 7, NULL, 21600, 3240, 18360),

-- 訂單18: 會員8, 週年活動, 3天2夜, 標準雙人房+豪華海景雙人房 (6人)
(8, '2025-10-28 17:20:00', 0, '2025-11-05', NULL, '2025-11-07', NULL, 
 8, '小朋友對花粉過敏，請盡量不要放置鮮花。', 50400, 12600, 37800),

-- 訂單19: 會員8, 無優惠專案, 2天1夜, 豪華海景家庭房 (4人)
(8, '2025-11-15 15:25:00', 0, '2025-12-01', NULL, '2025-12-02', NULL, 
 NULL, '請問是否可以借用電熱水壺？入住時再確認即可。', 18000, 0, 18000),

-- 訂單20: 會員7, 聖誕禮物, 3天2夜, 行政豪華月牙套房 (4人)
(7, '2025-12-20 12:50:00', 0, '2025-12-25', NULL, '2025-12-26', NULL, 
 9, '慶生之旅，若有小驚喜安排將不勝感激！', 57600, 11520, 46080),
 
 -- 訂單21 - 3天住宿，使用暑期優惠專案
(1, '2025-07-01 10:30:00', 1, '2025-07-05', '2025-07-05 15:00:00', '2025-07-08', '2025-07-08 11:00:00', 2, '商務出差', 32400, 5760, 26640),

-- 訂單22 - 2天住宿，使用暑期優惠專案
(2, '2025-06-28 14:20:00', 2, '2025-07-03', '2025-07-03 16:30:00', '2025-07-05', '2025-07-05 10:30:00', 2, '家庭旅遊', 28800, 5120, 23680),

-- 訂單23 - 1天住宿，使用暑期優惠專案
(3, '2025-07-02 09:15:00', 1, '2025-07-07', '2025-07-07 14:00:00', '2025-07-08', NULL, 2, '情侶約會', 14400, 2560, 11840),

-- 訂單24 - 4天住宿，使用暑期優惠專案
(4, '2025-06-30 16:45:00', 2, '2025-07-04', '2025-07-04 15:30:00', '2025-07-08', '2025-07-08 12:00:00', 2, '朋友聚會', 43200, 7680, 35520),

-- 訂單25 - 2天住宿，使用暑期優惠專案
(5, '2025-07-01 11:00:00', 1, '2025-07-06', '2025-07-06 16:00:00', '2025-07-08', NULL, 2, '蜜月旅行', 50400, 8960, 41440),

-- 訂單26 - 3天住宿，使用暑期優惠專案
(6, '2025-06-29 13:30:00', 2, '2025-07-02', '2025-07-02 15:00:00', '2025-07-05', '2025-07-05 11:30:00', 2, '員工旅遊', 64800, 11520, 53280),

-- 訂單27 - 1天住宿，使用暑期優惠專案
(7, '2025-07-03 08:45:00', 1, '2025-07-09', '2025-07-09 14:30:00', '2025-07-10', NULL, 2, '放鬆度假', 10800, 1920, 8880),

-- 訂單28 - 2天住宿，使用暑期優惠專案
(8, '2025-06-27 17:20:00', 2, '2025-07-04', '2025-07-04 16:30:00', '2025-07-06', '2025-07-06 10:00:00', 2, '親子旅遊', 43200, 7680, 35520),

-- 訂單29 - 3天住宿，無使用優惠專案
(1, '2025-07-05 12:00:00', 0, '2025-07-08', NULL, '2025-07-11', NULL, NULL, '臨時出差', 32400, 0, 32400),

-- 訂單30 - 1天住宿，無使用優惠專案
(3, '2025-07-04 15:30:00', 0, '2025-07-10', NULL, '2025-07-11', NULL, NULL, '會議住宿', 14400, 0, 14400),

-- 訂單31 - 2天住宿，使用暑期優惠專案
(1, '2025-07-01 09:30:00', 1, '2025-07-04', '2025-07-04 15:00:00', '2025-07-06', '2025-07-06 11:00:00', 2, '家庭度假', 43200, 6480, 36720),

-- 訂單32 - 3天住宿，使用暑期優惠專案
(2, '2025-06-30 14:20:00', 2, '2025-07-03', '2025-07-03 16:30:00', '2025-07-06', '2025-07-06 10:30:00', 2, '朋友聚會', 64800, 9720, 55080),

-- 訂單33 - 1天住宿，使用暑期優惠專案
(3, '2025-07-02 11:15:00', 1, '2025-07-05', '2025-07-05 14:00:00', '2025-07-06', NULL, 2, '商務出差', 32400, 4860, 27540),

-- 訂單34 - 4天住宿，使用暑期優惠專案
(4, '2025-06-29 16:45:00', 2, '2025-07-02', '2025-07-02 15:30:00', '2025-07-06', '2025-07-06 12:00:00', 2, '員工旅遊', 93600, 14040, 79560),

-- 訂單35 - 2天住宿，使用暑期優惠專案
(5, '2025-07-01 13:00:00', 1, '2025-07-07', '2025-07-07 16:00:00', '2025-07-09', NULL, 2, '情侶約會', 54000, 8100, 45900),

-- 訂單36 - 3天住宿，使用暑期優惠專案
(6, '2025-06-28 10:30:00', 2, '2025-07-05', '2025-07-05 15:00:00', '2025-07-08', '2025-07-08 11:30:00', 2, '蜜月旅行', 82800, 12420, 70380),

-- 訂單37 - 1天住宿，無使用優惠專案
(7, '2025-07-03 15:45:00', 0, '2025-07-08', NULL, '2025-07-09', NULL, NULL, '會議住宿', 28800, 0, 28800),

-- 訂單38 - 2天住宿，使用暑期優惠專案
(8, '2025-06-27 12:20:00', 2, '2025-07-06', '2025-07-06 16:30:00', '2025-07-08', '2025-07-08 10:00:00', 2, '親子旅遊', 43200, 6480, 36720),

-- 訂單39 - 3天住宿，使用暑期優惠專案
(1, '2025-07-04 08:00:00', 1, '2025-07-07', '2025-07-07 14:30:00', '2025-07-10', NULL, 2, '放鬆度假', 57600, 8640, 48960),

-- 訂單40 - 1天住宿，無使用優惠專案
(3, '2025-07-05 17:30:00', 0, '2025-07-09', NULL, '2025-07-10', NULL, NULL, '臨時住宿', 21600, 0, 21600),

-- 訂單 #41：入住 3 晚，專案：暑期優惠
(3, '2025-07-03 00:00:00', 0, '2025-07-07',NULL, '2025-07-10',NULL, 2, '3晚，專案：暑期優惠', 97200, 14580, 82620),

-- 訂單 #42：入住 1 晚，專案：暑期優惠
(3, '2025-06-29 00:00:00', 0, '2025-07-03',NULL, '2025-07-04',NULL, 2, '1晚，專案：暑期優惠', 32400, 4860, 27540),

-- 訂單 #43：入住 2 晚，專案：暑期優惠
(1, '2025-07-02 00:00:00', 0, '2025-07-06',NULL, '2025-07-08',NULL, 2, '2晚，專案：暑期優惠', 64800, 9720, 55080),

-- 訂單 #44：入住 2 晚，專案：暑期優惠
(7, '2025-07-04 00:00:00', 0, '2025-07-06',NULL, '2025-07-08',NULL, 2, '2晚，專案：暑期優惠', 50400, 7560, 42840),

-- 訂單 #45：入住 3 晚，專案：暑期優惠
(2, '2025-07-06 00:00:00', 0, '2025-07-10',NULL, '2025-07-13',NULL, 2, '3晚，專案：暑期優惠', 172800, 25920, 146880),

-- 訂單 #46：入住 3 晚，專案：暑期優惠
(4, '2025-07-02 00:00:00', 0, '2025-07-06',NULL, '2025-07-09',NULL, 2, '3晚，專案：暑期優惠', 108000, 16200, 91800),

-- 訂單 #47：入住 2 晚，專案：暑期優惠
(2, '2025-07-01 00:00:00', 0, '2025-07-04',NULL, '2025-07-06',NULL, 2, '2晚，專案：暑期優惠', 43200, 6480, 36720),

-- 訂單 #48：入住 2 晚，專案：暑期優惠
(4, '2025-07-02 00:00:00', 0, '2025-07-03',NULL, '2025-07-05',NULL, 2, '2晚，專案：暑期優惠', 93600, 14040, 79560),

-- 訂單 #49：入住 3 晚，專案：暑期優惠
(8, '2025-07-02 00:00:00', 0, '2025-07-05',NULL, '2025-07-08',NULL, 2, '3晚，專案：暑期優惠', 162000, 24300, 137700),

-- 訂單 #50：入住 2 晚，專案：暑期優惠
(2, '2025-07-01 00:00:00', 0, '2025-07-04',NULL, '2025-07-06',NULL, 2, '2晚，專案：暑期優惠', 64800, 9720, 55080);

UPDATE room_reservation_order
SET 
    room_order_status = CASE
        WHEN check_out_date < '2025-07-09' THEN 2  -- 已退房
        WHEN check_in_date <= '2025-07-09' AND check_out_date > '2025-07-09' THEN 1  -- 已入住
        ELSE 0  -- 成立
    END,
    
    actual_check_in_date = CASE
        WHEN check_out_date < '2025-07-09' THEN CONCAT(check_in_date, ' 15:00:00')
        WHEN check_in_date <= '2025-07-09' AND check_out_date > '2025-07-09' THEN CONCAT(check_in_date, ' 15:00:00')
        ELSE NULL
    END,

    actual_check_out_date = CASE
        WHEN check_out_date < '2025-07-09' THEN CONCAT(check_out_date, ' 11:00:00')
        ELSE NULL
    END 
    WHERE room_reservation_id BETWEEN 1 AND 50;

-- DROP TABLE IF EXISTS room_reservation_order;


-- 房型 room_type （詹力臻）
CREATE TABLE room_type (
	room_type_id			INT				AUTO_INCREMENT	PRIMARY KEY,						-- 房型編號 (PK)
	room_type_code			CHAR(3)			NOT NULL,											-- 房型代碼
	room_type_name			VARCHAR(10)		NOT NULL,											-- 房型名稱
	room_type_quantity		INT				NOT NULL,											-- 房間數量
	room_type_capacity		INT				NOT NULL,											-- 房間容納人數
	room_type_content		VARCHAR(1000)	NOT NULL,											-- 房間說明
	room_type_price			INT				NOT NULL,											-- 房間原價
	room_type_sale_status	TINYINT			NOT NULL	DEFAULT 0	COMMENT '0:下架中 1:上架中'	-- 房型上下架
);

INSERT INTO  room_type (room_type_id, room_type_code, room_type_name, room_type_quantity, room_type_capacity, room_type_content, room_type_price, room_type_sale_status)
VALUES (1, 'A01', '標準雙人房', 10, 2, '
        床型：雙人床
        坪數：9坪
        衛浴設備｜分離式淋浴、吹風機、盥洗用品（洗髮乳、沐浴乳、洗手乳)、免治馬桶
        娛樂｜Wi-Fi、液晶電視、有線頻道、國際直撥電話服務
        舒適設備｜Morning call、空調、室內拖鞋
        餐飲服務｜冰箱、快煮壺、即溶咖啡、茶包
        衣物與洗衣設備｜衣櫃衣架、洗衣乾洗服務
        安全特色｜晶片式安全感應門鎖', 10800, 1),
       (2, 'B02', '豪華海景雙人房', 5, 2, '
        床型：雙人床
        坪數：12坪
        衛浴設備｜分離式淋浴、浴缸、吹風機、盥洗用品（洗髮乳、沐浴乳、洗手乳)、免治馬桶
        娛樂｜Wi-Fi、液晶電視、有線頻道、國際直撥電話服務
        舒適設備｜Morning call、空調、室內拖鞋
        餐飲服務｜冰箱、即溶咖啡、茶包、快煮壺
        衣物與洗衣設備｜衣櫃衣架、洗衣乾洗服務
        安全特色｜晶片式安全感應門鎖', 14400, 1),
       (3, 'C03', '豪華家庭房', 8, 4, '
        床型：雙人床
        坪數：9坪
        衛浴設備｜分離式淋浴、吹風機、盥洗用品（洗髮乳、沐浴乳、洗手乳)、免治馬桶
        娛樂｜Wi-Fi、液晶電視、有線頻道、國際直撥電話服務
        舒適設備｜Morning call、空調、室內拖鞋
        餐飲服務｜冰箱、快煮壺、即溶咖啡、茶包
        衣物與洗衣設備｜衣櫃衣架、洗衣乾洗服務
        安全特色｜晶片式安全感應門鎖', 18000, 1),
       (4, 'D04', '豪華海景家庭房', 8, 4, '
        床型：雙人床
        坪數：12坪
        衛浴設備｜分離式淋浴、浴缸、吹風機、盥洗用品（洗髮乳、沐浴乳、洗手乳)、免治馬桶
        娛樂｜Wi-Fi、液晶電視、有線頻道、國際直撥電話服務
        舒適設備｜Morning call、空調、室內拖鞋
        餐飲服務｜冰箱、即溶咖啡、茶包、快煮壺
        衣物與洗衣設備｜衣櫃衣架、洗衣乾洗服務
        安全特色｜晶片式安全感應門鎖', 21600, 1),
       (5, 'E05', '海景樓中樓家庭房', 2, 6, '
        床型：雙人床
        坪數：18坪
        衛浴設備｜分離式淋浴、浴缸、吹風機、盥洗用品（洗髮乳、沐浴乳、洗手乳)、免治馬桶
        娛樂｜Wi-Fi、液晶電視、有線頻道、國際直撥電話服務
        舒適設備｜Morning call、空調、室內拖鞋
        餐飲服務｜冰箱、即溶咖啡、茶包、快煮壺
        衣物與洗衣設備｜衣櫃衣架、洗衣乾洗服務
        安全特色｜晶片式安全感應門鎖', 25200, 0),
       (6, 'F06', '行政豪華月牙套房', 3, 2, '
        床型：雙人床
        坪數：18坪
        衛浴設備｜分離式淋浴、浴缸、吹風機、盥洗用品（洗髮乳、沐浴乳、洗手乳)、免治馬桶
        娛樂｜Wi-Fi、液晶電視、有線頻道、國際直撥電話服務
        舒適設備｜Morning call、空調、室內拖鞋
        餐飲服務｜冰箱、即溶咖啡、茶包、快煮壺
        衣物與洗衣設備｜衣櫃衣架、洗衣乾洗服務
        安全特色｜晶片式安全感應門鎖', 28800, 0);

-- DROP TABLE IF EXISTS room_type;


-- 房間 room （詹力臻）
CREATE TABLE room (
    room_id			INT		NOT NULL,																-- 房號 (PK)
    room_type_id	INT		NOT NULL,																-- 房型編號 (FK)
    room_status		TINYINT	NOT NULL	DEFAULT 0	COMMENT '0:空房 1:入住中 2:待維修 3:待清潔 4:停用',	-- 房間狀態
    CONSTRAINT pk_room_id PRIMARY KEY (room_id),
    CONSTRAINT fk_room_room_type_id FOREIGN KEY (room_type_id) REFERENCES room_type(room_type_id)
);

INSERT INTO room (room_id, room_type_id, room_status)
VALUES (101,  1, 0),
       (201,  1, 0),
       (501,  1, 0),
       (502,  1, 0),
       (507,  1, 0),
       (508,  1, 0),
       (509,  1, 0),
       (602,  1, 0),
       (603,  1, 0),
       (607,  1, 2),
       (703,  1, 0),
       -- 房型1 共11間（空房10間，待維修1間）
       (301,  2, 0),
       (503,  2, 0),
       (505,  2, 0),
       (608,  2, 0),
       (609,  2, 0),
       -- 房型2 共5間（空房5間，待維修0間）
       (401,  3, 0),
	   (506,  3, 0),
       (601,  3, 0),
       (605,  3, 0),
       (606,  3, 0),
       (702,  3, 0),
       (705,  3, 0),
       (706,  3, 0),
       (707,  3, 2),
       (708,  3, 0),
       -- 房型3 共10間（空房9間，待維修1間）
       (701,  4, 0),
       (802,  4, 0),
       (803,  4, 0),
       (804,  4, 0),
       (805,  4, 0),
       (806,  4, 0),
       (902,  4, 0),
       -- 房型4 共7間（空房7間，待維修0間）
       (801,  5, 0),
       (901,  5, 0),
       (903,  5, 0),
       (905,  5, 0),
       -- 房型5 共4間（空房4間，待維修0間）
       (1001, 6, 0),
       (1002, 6, 0),
       (1003, 6, 0);
       -- 房型6 共3間（空房3間，待維修0間）
       
-- DROP TABLE IF EXISTS room;


-- 訂房明細 room_reservation_detail （陳薇淨）
CREATE TABLE room_reservation_detail(
    room_reservation_detail_id	INT		AUTO_INCREMENT,	-- 訂房明細編號 (PK)
    room_reservation_id			INT		NOT NULL,		-- 訂房編號 (FK)
    room_id						INT,	                -- 房號 (FK)
    room_type_id				INT		NOT NULL,		-- 房型編號 (FK)
    guest_count					INT		NOT NULL,		-- 入住人數
    room_price					INT		NOT NULL,		-- 購買時單價
    rv_discount_amount			INT		NOT NULL,		-- 折扣金額
    rv_paid_amount				INT		NOT NULL,		-- 實際付款金額
    CONSTRAINT pk_room_reservation_detail_id PRIMARY KEY(room_reservation_detail_id),
    CONSTRAINT fk_rrd_room_reservation_id FOREIGN KEY(room_reservation_id) REFERENCES room_reservation_order(room_reservation_id),
    CONSTRAINT fk_rrd_room_id FOREIGN KEY(room_id) REFERENCES room(room_id),
    CONSTRAINT fk_rrd_room_type_id FOREIGN KEY(room_type_id) REFERENCES room_type(room_type_id)
);

INSERT INTO room_reservation_detail (
    room_reservation_id, room_id, room_type_id, guest_count, 
    room_price, rv_discount_amount, rv_paid_amount
) VALUES 

-- 訂單1的明細 (1筆) (2人)
(1, 101, 1, 2, 10800, 4320, 6480), -- 備註:標準雙人房

-- 訂單2的明細 (3筆) (10人)
(2, 301, 2, 2, 28800, 4320, 24480), -- 備註:豪華海景雙人房
(2, 401, 3, 4, 43200, 6480, 36720), -- 備註:豪華家庭房
(2, 601, 3, 4, 21600, 3240, 18360), -- 備註:豪華家庭房

-- 訂單3的明細 (1筆) (2人)
(3, 101, 1, 2, 10800, 1620, 9180), -- 備註:標準雙人房

-- 訂單4的明細 (3筆) (10人)
(4, 301, 2, 2, 28800, 4320, 24480), -- 備註:豪華海景雙人房
(4, 401, 3, 4, 43200, 6480, 36720), -- 備註:豪華家庭房
(4, 702, 3, 4, 21600, 3240, 18360), -- 備註:豪華家庭房

-- 訂單5的明細 (1筆) (2人)
(5, 503, 2, 2, 14400, 2160, 12240), -- 備註:豪華海景雙人房

-- 訂單6的明細 (2筆) (8人)
(6, 506, 3, 4, 21600, 3240, 18360), -- 備註:豪華家庭房
(6, 601, 3, 4, 21600, 3240, 18360), -- 備註:豪華家庭房

-- 訂單7的明細 (4筆) (16人)
(7, 701, 4, 4, 18000, 2700, 15300), -- 備註:豪華海景家庭房
(7, 802, 4, 4, 18000, 2700, 15300), -- 備註:豪華海景家庭房
(7, 803, 4, 4, 18000, 2700, 15300), -- 備註:豪華海景家庭房
(7, 805, 4, 4, 18000, 2700, 15300), -- 備註:豪華海景家庭房

-- 訂單8的明細 (1筆) (2人)
(8, 201, 1, 2, 10800, 0, 10800), -- 備註:標準雙人房

-- 訂單9的明細 (1筆) (2人)
(9, 505, 2, 2, 14400, 2160, 12240), -- 備註:豪華海景雙人房

-- 訂單10的明細 (4筆) (12人)
(10, 501, 1, 2, 32400, 4860, 27540), -- 備註:標準雙人房
(10, 605, 3, 4, 32400, 4860, 27540), -- 備註:豪華家庭房
(10, 606, 3, 4, 32400, 4860, 27540), -- 備註:豪華家庭房
(10, 502, 1, 2, 10800, 1620, 9180), -- 備註:標準雙人房

-- 訂單11的明細 (1筆) (4人)
(11, 804, 4, 4, 18000, 0, 18000), -- 備註:豪華海景家庭房

-- 訂單12的明細 (2筆) (4人)
(12, 608, 2, 2, 14400, 2160, 12240), -- 備註:豪華海景雙人房
(12, 609, 2, 2, 14400, 2160, 12240), -- 備註:豪華海景雙人房


-- 訂單13的明細 (1筆) (2人)
(13, 201, 1, 2, 10800, 1080, 9720), 	-- 備註:標準雙人房

-- 訂單14的明細 (1筆) (2人)
(14, 501, 1, 2, 10800, 3240, 7560), 	-- 備註:標準雙人房

-- 訂單15的明細 (3筆) (6人)
(15, 503, 2, 2, 14400, 3600, 10800), -- 備註:豪華海景雙人房
(15, 505, 2, 2, 14400, 3600, 10800), -- 備註:豪華海景雙人房
(15, 609, 2, 2, 14400, 3600, 10800), -- 備註:豪華海景雙人房

-- 訂單16的明細 (4筆) (24人)
(16, 801, 5, 6, 25200, 3780, 21420), -- 備註:海景樓中樓家庭房
(16, 901, 5, 6, 25200, 3780, 21420), -- 備註:海景樓中樓家庭房
(16, 903, 5, 6, 25200, 3780, 21420), -- 備註:海景樓中樓家庭房
(16, 905, 5, 6, 25200, 3780, 21420), -- 備註:海景樓中樓家庭房

-- 訂單17的明細 (1筆) (4人)
(17, 506, 3, 4, 21600, 3240, 18360), -- 備註:豪華家庭房

-- 訂單18的明細 (3筆) (6人)
(18, 502, 1, 2, 21600, 5400, 16200), -- 備註:標準雙人房
(18, 608, 2, 2, 28800, 7200, 21600), -- 備註:豪華海景雙人房
(18, 507, 1, 2, 10800, 2700, 8100), 	-- 備註:標準雙人房

-- 訂單19的明細 (2筆) (4人)
(19, 1001, 6, 2, 28800, 5760, 23040), -- 備註:行政豪華月牙套房
(19, 1002, 6, 2, 28800, 5760, 23040), -- 備註:行政豪華月牙套房

-- 訂單20的明細 (1筆) (4人)
(20, 701, 4, 4, 18000, 0, 18000), 	-- 備註:豪華海景家庭房

-- 訂單21的明細 (3筆) - 標準雙人房
(21, NULL, 1, 2, 10800, 1920, 8880), -- 標準雙人房
(21, NULL, 1, 2, 10800, 1920, 8880), -- 標準雙人房
(21, NULL, 1, 2, 10800, 1920, 8880), -- 標準雙人房

-- 訂單22的明細 (2筆) - 豪華海景雙人房
(22, NULL, 2, 2, 14400, 2560, 11840), -- 豪華海景雙人房
(22, NULL, 2, 2, 14400, 2560, 11840), -- 豪華海景雙人房

-- 訂單23的明細 (1筆) - 豪華海景雙人房
(23, NULL, 2, 2, 14400, 2560, 11840), -- 豪華海景雙人房

-- 訂單24的明細 (2筆) - 豪華家庭房
(24, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房
(24, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房

-- 訂單25的明細 (2筆) - 豪華海景家庭房
(25, NULL, 4, 6, 25200, 4480, 20720), -- 豪華海景家庭房
(25, NULL, 4, 6, 25200, 4480, 20720), -- 豪華海景家庭房

-- 訂單26的明細 (3筆) - 豪華家庭房
(26, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房
(26, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房
(26, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房

-- 訂單27的明細 (1筆) - 標準雙人房
(27, NULL, 1, 2, 10800, 1920, 8880), -- 標準雙人房

-- 訂單28的明細 (2筆) - 豪華家庭房
(28, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房
(28, NULL, 3, 4, 21600, 3840, 17760), -- 豪華家庭房

-- 訂單29的明細 (3筆) - 標準雙人房
(29, NULL, 1, 2, 10800, 0, 10800), -- 標準雙人房
(29, NULL, 1, 2, 10800, 0, 10800), -- 標準雙人房
(29, NULL, 1, 2, 10800, 0, 10800), -- 標準雙人房

-- 訂單30的明細 (1筆) - 豪華海景雙人房
(30, NULL, 2, 2, 14400, 0, 14400), -- 豪華海景雙人房

-- 訂單31的明細 (2筆) - 標準雙人房 + 豪華家庭房
(31, 101, 1, 2, 10800, 1620, 9180), -- 標準雙人房
(31, 401, 3, 4, 21600, 3240, 18360), -- 豪華家庭房

-- 訂單32的明細 (3筆) - 標準雙人房 + 豪華海景雙人房 + 豪華家庭房
(32, 201, 1, 2, 10800, 1620, 9180), -- 標準雙人房
(32, 301, 2, 2, 14400, 2160, 12240), -- 豪華海景雙人房
(32, 506, 3, 4, 21600, 3240, 18360), -- 豪華家庭房

-- 訂單33的明細 (1筆) - 標準雙人房 + 豪華海景雙人房
(33, 501, 1, 2, 10800, 1620, 9180), -- 標準雙人房
(33, 503, 2, 2, 14400, 2160, 12240), -- 豪華海景雙人房

-- 訂單34的明細 (4筆) - 標準雙人房 + 豪華海景雙人房 + 豪華家庭房 + 豪華海景家庭房
(34, 502, 1, 2, 10800, 1620, 9180), -- 標準雙人房
(34, 505, 2, 2, 14400, 2160, 12240), -- 豪華海景雙人房
(34, 601, 3, 4, 21600, 3240, 18360), -- 豪華家庭房
(34, 701, 4, 6, 25200, 3780, 21420), -- 豪華海景家庭房

-- 訂單35的明細 (2筆) - 豪華海景雙人房 + 豪華海景家庭房
(35, 608, 2, 2, 14400, 2160, 12240), -- 豪華海景雙人房
(35, 802, 4, 6, 25200, 3780, 21420), -- 豪華海景家庭房

-- 訂單36的明細 (3筆) - 豪華海景雙人房 + 豪華家庭房 + 豪華海景家庭房
(36, 609, 2, 2, 14400, 2160, 12240), -- 豪華海景雙人房
(36, 605, 3, 4, 21600, 3240, 18360), -- 豪華家庭房
(36, 803, 4, 6, 25200, 3780, 21420), -- 豪華海景家庭房

-- 訂單37的明細 (1筆) - 行政豪華月牙套房
(37, 1001, 6, 2, 28800, 0, 28800), -- 行政豪華月牙套房

-- 訂單38的明細 (2筆) - 標準雙人房 + 豪華家庭房
(38, 507, 1, 2, 10800, 1620, 9180), -- 標準雙人房
(38, 606, 3, 4, 21600, 3240, 18360), -- 豪華家庭房

-- 訂單39的明細 (3筆) - 豪華海景雙人房 + 豪華家庭房 + 海景樓中樓家庭房
(39, 301, 2, 2, 14400, 2160, 12240), -- 豪華海景雙人房
(39, 702, 3, 4, 21600, 3240, 18360), -- 豪華家庭房
(39, 801, 5, 6, 25200, 0, 25200), -- 海景樓中樓家庭房

-- 訂單40的明細 (1筆) - 豪華家庭房
(40, 705, 3, 4, 21600, 0, 21600), -- 豪華家庭房

-- 訂單 #41 明細
(41, 101, 1, 2, 32400, 4860, 27540), -- 標準雙人房
(41, 401, 3, 4, 64800, 9720, 55080), -- 豪華家庭房

-- 訂單 #42 明細
(42, 201, 1, 2, 10800, 1620, 9180), -- 標準雙人房
(42, 506, 3, 4, 21600, 3240, 18360), -- 豪華家庭房

-- 訂單 #43 明細
(43, 501, 1, 2, 21600, 3240, 18360), -- 標準雙人房
(43, 601, 3, 4, 43200, 6480, 36720), -- 豪華家庭房

-- 訂單 #44 明細
(44, 301, 2, 2, 28800, 4320, 24480), -- 豪華海景雙人房
(44, 502, 1, 2, 21600, 3240, 18360), -- 標準雙人房

-- 訂單 #45 明細
(45, 605, 3, 4, 64800, 9720, 55080), -- 豪華家庭房
(45, 701, 4, 4, 64800, 9720, 55080), -- 豪華海景家庭房
(45, 503, 2, 2, 43200, 6480, 36720), -- 豪華海景雙人房

-- 訂單 #46 明細
(46, 505, 2, 2, 43200, 6480, 36720), -- 豪華海景雙人房
(46, 802, 4, 4, 64800, 9720, 55080), -- 豪華海景家庭房

-- 訂單 #47 明細
(47, 606, 3, 4, 43200, 6480, 36720), -- 豪華家庭房

-- 訂單 #48 明細
(48, 507, 1, 2, 21600, 3240, 18360), -- 標準雙人房
(48, 608, 2, 2, 28800, 4320, 24480), -- 豪華海景雙人房
(48, 702, 3, 4, 43200, 6480, 36720), -- 豪華家庭房

-- 訂單 #49 明細
(49, 705, 3, 4, 64800, 9720, 55080), -- 豪華家庭房
(49, 803, 4, 4, 64800, 9720, 55080), -- 豪華海景家庭房
(49, 508, 1, 2, 32400, 4860, 27540), -- 標準雙人房

-- 訂單 #50 明細
(50, 509, 1, 2, 21600, 3240, 18360), -- 標準雙人房
(50, 706, 3, 4, 43200, 6480, 36720); -- 豪華家庭房

-- DROP TABLE IF EXISTS room_reservation_detail;


-- 房型優惠價格 room_promotion_price （曾宸瑩）
CREATE TABLE room_promotion_price (
	room_promotion_id		INT				NOT NULL,		-- 優惠專案編號 (PK, FK)
	room_type_id			INT				NOT NULL,		-- 房型編號 (PK, FK)
	promotion_start_date	DATE			NOT NULL,		-- 專案開始日期
	promotion_end_date		DATE			NOT NULL,		-- 專案結束日期
	room_discount_rate		DECIMAL(3,2)	DEFAULT 1.0,	-- 房間折扣率
	promotion_remark		VARCHAR(50),					-- 專案備註
	CONSTRAINT pk_room_promotion_id_room_type_id PRIMARY KEY (room_promotion_id, room_type_id),
	FOREIGN KEY (room_promotion_id) REFERENCES promotion (room_promotion_id) ,
	FOREIGN KEY (room_type_id) REFERENCES room_type (room_type_id)
);

INSERT INTO room_promotion_price (room_promotion_id, room_type_id, promotion_start_date, promotion_end_date, room_discount_rate, promotion_remark)
VALUES 
       -- 1. 春假專案：針對雙人房 6 折吸引學生族群
       (1, 1, '2025-03-10', '2025-03-20', 0.60, '針對雙人房 6 折吸引學生族群'),  -- 標準雙人房 6 折
       (1, 2,'2025-03-10', '2025-03-20', 0.60, '針對雙人房 6 折吸引學生族群'),  -- 豪華海景雙人房 6 折
       -- 2. 暑期優惠：指定房型 85 折
       (2, 1, '2025-07-01', '2025-08-31', 0.85, '指定房型 85 折'),  -- 標準雙人房 85 折
       (2, 2, '2025-07-01', '2025-08-31', 0.85, '指定房型 85 折'),  -- 豪華海景雙人房 85 折
       (2, 3, '2025-07-01', '2025-08-31', 0.85, '指定房型 85 折'),  -- 豪華家庭房 85 折
       (2, 4, '2025-07-01', '2025-08-31', 0.85, '指定房型 85 折'),  -- 豪華海景家庭房 85 折
       -- 3. 週末快閃特惠：僅雙人房（含海景）享 9 折
       (3, 1, '2025-09-06', '2025-09-08', 0.9, '雙人房（含海景）享 9 折'),  -- 標準雙人房 9 折
       (3, 2, '2025-09-06', '2025-09-08', 0.9, '雙人房（含海景）享 9 折'),  -- 豪華海景雙人房 9 折
       -- 4. 限時快閃：便宜房型超低 7 折
       (4, 1, '2025-09-15', '2025-09-17', 0.7, '便宜房型超低 7 折'),  -- 標準雙人房 7 折
       -- 5. 早鳥優惠：雙人房 75 折
       (5, 1, '2025-10-01', '2025-10-15', 0.75, '雙人房 75 折'),  -- 標準雙人房 75 折
       (5, 2, '2025-10-01', '2025-10-15', 0.75, '雙人房 75 折'),  -- 豪華海景雙人房 75 折
       -- 6. 中秋促銷：海景房型中秋優惠
       (6, 2, '2025-10-03', '2025-10-06', 0.85, '海景房型中秋優惠'),  -- 豪華海景雙人房 85 折
       (6, 4, '2025-10-03', '2025-10-06', 0.85, '海景房型中秋優惠'),  -- 豪華海景家庭房 85 折
       (6, 5, '2025-10-03', '2025-10-06', 0.85, '海景房型中秋優惠'),  -- 海景樓中樓家庭房 85 折
       -- 7. 秋季放鬆：中價房型舒壓優惠
       (7, 2, '2025-10-20', '2025-10-31', 0.85, '中價房型舒壓優惠'),  -- 豪華海景雙人房 85 折
       (7, 3, '2025-10-20', '2025-10-31', 0.85, '中價房型舒壓優惠'),  -- 豪華家庭房 85 折
       -- 8. 週年活動：超大優惠回饋
       (8, 1, '2025-11-01', '2025-11-10', 0.75, '週年超大優惠回饋'),  -- 標準雙人房 75 折
       (8, 2, '2025-11-01', '2025-11-10', 0.75, '週年超大優惠回饋'),  -- 豪華海景雙人房 75 折
       (8, 3, '2025-11-01', '2025-11-10', 0.75, '週年超大優惠回饋'),  -- 豪華家庭房 75 折
       -- 9. 聖誕禮物：最高價房型專屬折扣
       (9, 5, '2025-12-24', '2025-12-26', 0.8, '最高價房型專屬折扣'),  -- 海景樓中樓家庭房 8 折
       (9, 6, '2025-12-24', '2025-12-26', 0.8, '最高價房型專屬折扣'),  -- 行政豪華月牙套房 8 折
       -- 10. 元旦開年優惠：全館限量 8 折
       (10, 1, '2026-01-01', '2026-01-07', 0.8, '全館限量 8 折'),  -- 標準雙人房 8 折
       (10, 2, '2026-01-01', '2026-01-07', 0.8, '全館限量 8 折'),  -- 豪華海景雙人房 8 折
       (10, 3, '2026-01-01', '2026-01-07', 0.8, '全館限量 8 折'),  -- 豪華家庭房 8 折
       (10, 4, '2026-01-01', '2026-01-07', 0.8, '全館限量 8 折');  -- 豪華海景家庭房 8 折

-- DROP TABLE IF EXISTS room_promotion_price;


-- 房型圖片 room_type_photo （詹力臻）
CREATE TABLE room_type_photo (
    room_type_photo_id  INT       AUTO_INCREMENT,  -- 房型圖片編號 (PK) (AI)
    room_type_id        INT       NOT NULL,        -- 房型編號 (FK)
    room_type_photo     LONGBLOB,                  -- 房型圖片
    display_order        INT            NOT NULL,                        -- 圖片順序
    CONSTRAINT pk_room_type_photo_id PRIMARY KEY (room_type_photo_id),
    CONSTRAINT fk_room_type_id FOREIGN KEY (room_type_id) REFERENCES room_type(room_type_id)
);

INSERT INTO room_type_photo (room_type_id,display_order)
VALUES (1,0),
       (1,1),
       (1,2),
       (2,0),
       (2,1),
       (2,2),
       (3,0),
       (3,1),
       (3,2),
       (4,0),
       (4,1),
       (4,2),
       (5,0),
       (5,1),
       (5,2),
       (6,0),
       (6,1),
       (6,2);

-- DROP TABLE IF EXISTS room_type_photo;


-- 各房型空房庫存量 room_type_availability （詹力臻）
CREATE TABLE room_type_availability(
	room_type_id                  INT   NOT NULL,
	room_type_availability_date   DATE  NOT NULL,
	room_type_availability_count  INT   NOT NULL,
	CONSTRAINT pk_room_type_id_room_type_availability_date PRIMARY KEY (room_type_id, room_type_availability_date),
	CONSTRAINT fk_room_type_availability_room_type_id FOREIGN KEY (room_type_id) REFERENCES room_type(room_type_id)
);

INSERT INTO room_type_availability (room_type_id, room_type_availability_date, room_type_availability_count)
VALUES (1, '2024-03-10', 9),
       (1, '2024-03-11', 9),
       (1, '2024-03-12', 9),
       (1, '2024-03-13', 9),
       (1, '2024-03-14', 9),
       (1, '2024-03-15', 10),
       (1, '2025-01-26', 9),
       (3, '2025-01-26', 7),
       (5, '2025-01-26', 3),
       (1, '2025-01-27', 9),
       (3, '2025-01-27', 7),
       (5, '2025-01-27', 3),
       (1, '2025-01-28', 9),
       (3, '2025-01-28', 7),
       (5, '2025-01-28', 3),
       (1, '2025-01-29', 9),
       (3, '2025-01-29', 7),
       (5, '2025-01-29', 3),
       (1, '2025-01-30', 9),
       (3, '2025-01-30', 7),
       (5, '2025-01-30', 3),
       (1, '2025-01-31', 10),
       (3, '2025-01-31', 9),
       (5, '2025-01-31', 4),
       (1, '2025-05-17', 9),
       (2, '2025-05-17', 4),
       (1, '2025-05-18', 10),
       (2, '2025-05-18', 5),
       (5, '2025-05-21', 3),
       (5, '2025-05-22', 4),
       (4, '2025-07-25', 6),
       (6, '2025-07-25', 2),
       (4, '2025-07-26', 6),
       (6, '2025-07-26', 2),
       (4, '2025-07-27', 6),
       (6, '2025-07-27', 2),
       (4, '2025-07-28', 6),
       (6, '2025-07-28', 2),
       (4, '2025-07-29', 7),
       (6, '2025-07-29', 3);
-- DROP TABLE IF EXISTS room_type_availability;


/***************************************************************************************************
********************************************* 接駁相關 *********************************************
***************************************************************************************************/


-- 接駁班次 shuttle_schedule （王人慶）
CREATE TABLE shuttle_schedule (
	shuttle_schedule_id		INT		AUTO_INCREMENT	PRIMARY KEY,			-- 接駁班次編號 
	shuttle_direction		TINYINT	NOT NULL		COMMENT '0:去程 1:回程',	-- 去回程
	shuttle_departure_time	TIME	NOT NULL,								-- 出發時間
	shuttle_arrival_time	TIME	NOT NULL								-- 抵達時間
);

INSERT INTO shuttle_schedule (shuttle_direction, shuttle_departure_time, shuttle_arrival_time) 
VALUES (0, '08:00:00', '09:00:00'), -- 班次1 去程  8- 9
	   (1, '09:00:00', '10:00:00'), -- 班次2 回程  9-10
       (0, '10:00:00', '11:00:00'), -- 班次3 去程 10-11
       (1, '11:00:00', '12:00:00'), -- 班次4 回程 11-12
       (0, '14:00:00', '15:00:00'), -- 班次5 去程 14-15
       (1, '15:00:00', '16:00:00'), -- 班次6 回程 15-16
       (0, '16:00:00', '17:00:00'), -- 班次7 去程 16-17
       (1, '17:00:00', '18:00:00'); -- 班次8 回程 17-18

-- DROP TABLE IF EXISTS shuttle_schedule;


-- 接駁預約 shuttle_reservation （賴彥儒）
CREATE TABLE shuttle_reservation (
	shuttle_reservation_id		INT		AUTO_INCREMENT	PRIMARY KEY,		-- 接駁預約編號 (PK) (AI)
    member_id					INT		NOT NULL,							-- 會員編號 (FK)
    room_reservation_id			INT		NOT NULL,							-- 訂房編號 (FK)
    shuttle_date				DATE	NOT NULL,							-- 接駁日期
    shuttle_schedule_id			INT		NOT NULL,							-- 接駁班次編號 (FK)
    shuttle_direction			TINYINT	NOT NULL	COMMENT '0:去程 1:回程',	-- 接駁去回程
    shuttle_number				INT		NOT NULL,							-- 接駁人數
    shuttle_reservation_status	TINYINT	NOT NULL	COMMENT '0:取消 1:正常',	-- 接駁預約狀態
    FOREIGN KEY(member_id) REFERENCES members(member_id),
    FOREIGN KEY(room_reservation_id) REFERENCES room_reservation_order(room_reservation_id),
    FOREIGN KEY(shuttle_schedule_id) REFERENCES shuttle_schedule(shuttle_schedule_id)
);

INSERT INTO shuttle_reservation (member_id, room_reservation_id, shuttle_date, shuttle_schedule_id, shuttle_direction, shuttle_number, shuttle_reservation_status)
VALUES (1,  1, '2025-03-12', 5, 0,  2, 1), -- 訂單1   2人 班次5 去程
	   (1,  1, '2025-03-13', 4, 1,  2, 0), -- 訂單1   2人 班次4 回程 取消
	   (1,  1, '2025-03-13', 6, 1,  2, 1), -- 訂單1   2人 班次6 回程
       (2,  2, '2025-07-15', 1, 0, 10, 1), -- 訂單2  10人 班次1 去程
       (2,  2, '2025-07-17', 2, 1, 10, 1), -- 訂單2  10人 班次2 回程
       (1,  3, '2025-07-05', 3, 0,  2, 1), -- 訂單3   2人 班次3 去程
       (1,  3, '2025-07-06', 4, 1,  2, 1), -- 訂單3   2人 班次4 回程
       (2,  4, '2025-07-15', 3, 0, 10, 0), -- 訂單4  10人 班次3 去程 取消
       (2,  4, '2025-07-15', 5, 0, 10, 1), -- 訂單4  10人 班次5 去程
       (2,  4, '2025-07-17', 6, 1, 10, 1), -- 訂單4  10人 班次6 回程
       (3,  5, '2025-07-20', 7, 0,  2, 1), -- 訂單5   2人 班次7 去程
       (3,  5, '2025-07-21', 8, 1,  2, 1), -- 訂單5   2人 班次8 回程
       (4,  6, '2025-07-25', 1, 0,  8, 1), -- 訂單6   8人 班次1 去程
       (4,  6, '2025-07-27', 2, 1,  8, 1), -- 訂單6   8人 班次2 回程
       (5,  7, '2025-07-12', 3, 0, 16, 1), -- 訂單7  16人 班次3 去程
       (5,  7, '2025-07-15', 4, 1, 16, 1), -- 訂單7  16人 班次4 回程
       (6,  8, '2025-07-28', 5, 0,  2, 1), -- 訂單8   2人 班次5 去程
       (6,  8, '2025-07-29', 6, 1,  2, 1), -- 訂單8   2人 班次6 回程
       (7,  9, '2025-07-30', 7, 0,  2, 1), -- 訂單9   2人 班次7 去程
       (7,  9, '2025-07-31', 8, 1,  2, 1), -- 訂單9   2人 班次8 回程
       (8, 10, '2025-07-22', 1, 0, 12, 1), -- 訂單10 12人 班次1 去程
       (8, 10, '2025-07-25', 2, 1, 12, 1); -- 訂單10 12人 班次2 回程
       /*
       (1, 11, '2025-07-26', 3, 0,  4, 1), -- 訂單11  4人 班次3 去程
       (1, 11, '2025-07-27', 4, 1,  4, 1), -- 訂單11  4人 班次4 回程
       (2, 12, '2025-07-29', 5, 0,  4, 1), -- 訂單12  4人 班次5 去程
       (2, 12, '2025-07-31', 6, 1,  4, 1), -- 訂單12  4人 班次6 回程
       (3, 13, '2025-09-07', 7, 0,  2, 1), -- 訂單13  2人 班次7 去程
       (3, 13, '2025-09-08', 8, 1,  2, 1), -- 訂單13  2人 班次8 回程
       (4, 14, '2025-09-16', 1, 0,  2, 1), -- 訂單14  2人 班次1 去程
       (4, 14, '2025-09-17', 2, 1,  2, 1), -- 訂單14  2人 班次2 回程
       (5, 15, '2025-10-10', 3, 0,  6, 1), -- 訂單15  6人 班次3 去程
       (5, 15, '2025-10-12', 4, 1,  6, 1), -- 訂單15  6人 班次4 回程
       (6, 16, '2025-10-04', 5, 0, 24, 1), -- 訂單16 24人 班次5 去程
       (6, 16, '2025-10-06', 6, 1, 24, 1), -- 訂單16 24人 班次6 回程
       (7, 17, '2025-10-25', 7, 0,  4, 1), -- 訂單17  4人 班次7 去程
       (7, 17, '2025-10-26', 8, 1,  4, 1), -- 訂單17  4人 班次8 回程
       (8, 18, '2025-11-05', 1, 0,  6, 1), -- 訂單18  6人 班次1 去程
       (8, 18, '2025-11-07', 2, 1,  6, 1), -- 訂單18  6人 班次2 回程
       (8, 19, '2025-12-01', 3, 0,  4, 1), -- 訂單19  4人 班次3 去程
       (8, 19, '2025-12-02', 4, 1,  4, 1), -- 訂單19  4人 班次4 回程
       (7, 20, '2025-12-25', 5, 0,  4, 1), -- 訂單20  4人 班次5 去程
       (7, 20, '2025-12-26', 6, 1,  4, 1); -- 訂單20  4人 班次6 回程
       */

-- DROP TABLE IF EXISTS shuttle_reservation;


-- 座位 seat （王人慶）
CREATE TABLE seat (
	seat_id      INT          AUTO_INCREMENT  PRIMARY KEY,      -- 座位編號 (PK)
	seat_number  VARCHAR(10)  NOT NULL,                         -- 座號
	seat_status  TINYINT      NOT NULL  COMMENT '0:故障 1:正常'  -- 座位狀態
);

INSERT INTO seat (seat_number, seat_status) -- 故障：4, 68, 98
VALUES ('A01', 1), ('A02', 1), ('A03', 1), ('A04', 0), ('A05', 1), ('A06', 1), ('A07', 1), ('A08', 1), ('A09', 1), ('A10', 1), -- 01~10
	   ('B01', 1), ('B02', 1), ('B03', 1), ('B04', 1), ('B05', 1), ('B06', 1), ('B07', 1), ('B08', 1), ('B09', 1), ('B10', 1), -- 11~20
	   ('C01', 1), ('C02', 1), ('C03', 1), ('C04', 1), ('C05', 1), ('C06', 1), ('C07', 1), ('C08', 1), ('C09', 1), ('C10', 1), -- 21~30
       ('D01', 1), ('D02', 1), ('D03', 1), ('D04', 1), ('D05', 1), ('D06', 1), ('D07', 1), ('D08', 1), ('D09', 1), ('D10', 1), -- 31~40
       ('E01', 1), ('E02', 1), ('E03', 1), ('E04', 1), ('E05', 1), ('E06', 1), ('E07', 1), ('E08', 1), ('E09', 1), ('E10', 1), -- 41~50
       ('F01', 1), ('F02', 1), ('F03', 1), ('F04', 1), ('F05', 1), ('F06', 1), ('F07', 1), ('F08', 1), ('F09', 1), ('F10', 1), -- 51~60
       ('G01', 1), ('G02', 1), ('G03', 1), ('G04', 1), ('G05', 1), ('G06', 1), ('G07', 1), ('G08', 0), ('G09', 1), ('G10', 1), -- 61~70
       ('H01', 1), ('H02', 1), ('H03', 1), ('H04', 1), ('H05', 1), ('H06', 1), ('H07', 1), ('H08', 1), ('H09', 1), ('H10', 1), -- 71~80
       ('I01', 1), ('I02', 1), ('I03', 1), ('I04', 1), ('I05', 1), ('I06', 1), ('I07', 1), ('I08', 1), ('I09', 1), ('I10', 1), -- 81~90
       ('J01', 1), ('J02', 1), ('J03', 1), ('J04', 1), ('J05', 1), ('J06', 1), ('J07', 1), ('J08', 0), ('J09', 1), ('J10', 1); -- 91~100

-- DROP TABLE IF EXISTS seat_availability;


-- 接駁預約座位對應 shuttle_reservation_seat （賴彥儒）
CREATE TABLE shuttle_reservation_seat (
	shuttle_reservation_id	INT	NOT NULL,	-- 接駁預約編號 (PK, FK)
    seat_id					INT	NOT NULL,	-- 座位編號 (PK, FK)
    CONSTRAINT pk_shuttle_reservation_seat_id PRIMARY KEY(shuttle_reservation_id, seat_id),
    CONSTRAINT fk_shuttle_reservation_id FOREIGN KEY(shuttle_reservation_id) REFERENCES shuttle_reservation(shuttle_reservation_id),
    CONSTRAINT fk_seat_id FOREIGN KEY(seat_id) REFERENCES seat(seat_id)
);

INSERT INTO shuttle_reservation_seat (shuttle_reservation_id, seat_id)
VALUES (1,   1),  (1,  2),  -- 訂單1 預約編號1 2人
       (3,   3),  (3,  5),  -- 訂單1 預約編號3 2人
       (4,   6),  (4,  7),  (4,  8),  (4,  9),  (4,  10),  (4, 11),  (4, 12),  (4, 13),  (4, 14),  (4, 15),  -- 訂單2 預約編號4 10人
       (5,  16),  (5, 17),  (5, 18),  (5, 19),  (5,  20),  (5, 21),  (5, 22),  (5, 23),  (5, 24),  (5, 25),  -- 訂單2 預約編號5 10人
       (6,  26),  (6, 27),  -- 訂單3 預約編號6 2人
       (7,  28),  (7, 29),  -- 訂單3 預約編號7 2人
       (9,  30),  (9, 31),  (9, 32),  (9, 33),  (9,  34),  (9, 35),  (9, 36),  (9, 37),  (9, 38),  (9, 39),  -- 訂單4 預約編號9  10人
       (10, 40), (10, 41), (10, 42), (10, 43), (10,  44), (10, 45), (10, 46), (10, 47), (10, 48), (10, 49),  -- 訂單4 預約編號10 10人
       (11, 50), (11, 51),  -- 訂單5 預約編號11 2人
       (12, 52), (12, 53),  -- 訂單5 預約編號12 2人
       (13, 54), (13, 55), (13, 56), (13, 57), (13,  58), (13, 59), (13, 60), (13, 61),  -- 訂單6 預約編號13 8人
       (14, 62), (14, 63), (14, 64), (14, 65), (14,  66), (14, 67), (14, 69), (14, 70),  -- 訂單6 預約編號14 8人
       (15, 71), (15, 72), (15, 73), (15, 74), (15,  75), (15, 76), (15, 77), (15, 78),
       (15, 79), (15, 80), (15, 81), (15, 82), (15,  83), (15, 84), (15, 85), (15, 86),  -- 訂單7 預約編號15 16人
       (16, 87), (16, 88), (16, 89), (16, 90), (16,  91), (16, 92), (16, 93), (16, 94),
       (16, 95), (16, 96), (16, 97), (16, 99), (16, 100), (16,  1), (16,  2), (16,  3),  -- 訂單7 預約編號16 16人
       (17,  5), (17,  6),  -- 訂單8 預約編號17 2人
       (18,  7), (18,  8),  -- 訂單8 預約編號18 2人
       (19,  9), (19, 10),  -- 訂單9 預約編號19 2人
       (20, 11), (20, 12),  -- 訂單9 預約編號20 2人
       (21, 13), (21, 14), (21, 15), (21, 16), (21, 17), (21, 18),
       (21, 19), (21, 20), (21, 21), (21, 22), (21, 23), (21, 24),  -- 訂單10 預約編號21 12人
       (22, 25), (22, 26), (22, 27), (22, 28), (22, 29), (22, 30),
       (22, 31), (22, 32), (22, 33), (22, 34), (22, 35), (22, 36);  -- 訂單10 預約編號22 12人

-- DROP TABLE IF EXISTS shuttle_reservation_seat;


-- 各接駁班次座位剩餘量 shuttle_seat_availability（王人慶）
CREATE TABLE shuttle_seat_availability (
	shuttle_schedule_id	INT			NOT NULL,					-- 接駁班次編號 (PK, FK)
	shuttle_date		DATE		NOT NULL,					-- 日期 (PK)
	seat_quantity		INT			NOT NULL  DEFAULT '100',	-- 座位剩餘數量
	seat_updated_at		DATETIME	NOT NULL,					-- 座位最後更新時間
	CONSTRAINT pk_shuttle_seat_availability PRIMARY KEY(shuttle_schedule_id, shuttle_date),
	CONSTRAINT fk_shuttle_seat_availability_shuttle_schedule FOREIGN KEY(shuttle_schedule_id) REFERENCES shuttle_schedule (shuttle_schedule_id)
);

INSERT INTO shuttle_seat_availability (shuttle_schedule_id, shuttle_date, seat_quantity, seat_updated_at)
VALUES (5, '2025-03-12', 98, '2025-03-10 07:30:00'),
       (4, '2025-03-13', 100,'2025-03-13 08:30:00'),
       (6, '2025-03-13', 98, '2025-03-13 08:30:00'),
       (1, '2025-07-15', 87, '2025-05-17 09:30:00'),
       (2, '2025-07-17', 87, '2025-05-18 10:30:00'),
       (3, '2025-07-05', 95, '2025-01-26 13:30:00'),
       (4, '2025-07-06', 95, '2025-01-31 14:30:00'),
       (3, '2025-07-15', 97, '2025-05-20 15:30:00'),
       (5, '2025-07-15', 87, '2025-05-21 15:30:00'),
       (6, '2025-07-17', 87, '2025-05-22 16:30:00'),
       (7, '2025-07-20', 95, '2025-07-25 07:30:00'),
       (8, '2025-07-21', 95, '2025-07-29 08:30:00'),
       (1, '2025-07-25', 89, '2025-05-18 10:30:00'),
       (2, '2025-07-27', 89, '2025-01-26 13:30:00'),
       (3, '2025-07-12', 81, '2025-01-31 14:30:00'),
       (4, '2025-07-15', 81, '2025-05-20 15:30:00'),
       (5, '2025-07-28', 95, '2025-05-21 15:30:00'),
       (6, '2025-07-29', 95, '2025-05-22 16:30:00'),
       (7, '2025-07-30', 95, '2025-07-25 07:30:00'),
       (8, '2025-07-31', 95, '2025-05-21 15:30:00'),
       (1, '2025-07-22', 85, '2025-05-22 16:30:00'),
       (2, '2025-07-25', 85, '2025-07-25 07:30:00');

-- DROP TABLE IF EXISTS shuttle_seat_availability;


-- 臨時接駁預約請求表（用於多步驟預約流程）（賴彥儒）
CREATE TABLE temp_shuttle_reservation_request (
    id                    INT AUTO_INCREMENT PRIMARY KEY,
    member_id             INT NOT NULL,
    room_reservation_id   INT NOT NULL,
    shuttle_date          DATE NOT NULL,
    shuttle_number        INT NOT NULL,
    shuttle_direction     INT NOT NULL COMMENT '0:去程 1:回程',
    selected_schedule_id  INT,
    selected_seat_ids     VARCHAR(255) COMMENT '座位ID列表，以逗號分隔',
    created_at            TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_member_date (member_id, shuttle_date),
    INDEX idx_created_at (created_at)
);

-- DROP TABLE IF EXISTS temp_shuttle_reservation_request;

/***************************************************************************************************
********************************************* 購物相關 *********************************************
***************************************************************************************************/


-- 商品種類 product_category （陳吟瑄）
CREATE TABLE product_category (
	product_category_id    INT          AUTO_INCREMENT  PRIMARY KEY,  -- 商品種類編號 (PK) (AI)
	product_category_name  VARCHAR(20)  NOT NULL                      -- 商品種類名稱
);

INSERT INTO product_category (product_category_name)
VALUES ('食物禮盒'),
	   ('配件飾品'),
       ('香氛系列'),
       ('精選小物');

-- DROP TABLE IF EXISTS product_category;


-- 商品 product （陳吟瑄）
CREATE TABLE product (
    product_id           INT           AUTO_INCREMENT  PRIMARY KEY,        -- 商品編號 (PK) (AI)
    product_category_id  INT           NOT NULL,                           -- 商品種類編號 (FK)
    product_name         VARCHAR(20)   NOT NULL,                           -- 商品名稱
    product_price        INT           NOT NULL,                           -- 商品價格
    product_description  VARCHAR(100)  NOT NULL,                           -- 商品描述
    product_quantity     INT           NOT NULL,                           -- 商品數量
    product_status       TINYINT       NOT NULL  COMMENT '0:下架 1:上架',  -- 商品狀態
    FOREIGN KEY (product_category_id) REFERENCES product_category(product_category_id)
);

INSERT INTO product (product_category_id, product_name, product_price, product_description, product_quantity, product_status)
VALUES
    (1, '咖啡禮盒', 1990, '帶有海島氣息的選品，為日常注入暖香片刻，適合分享也適合獨享。', 124, 1),
    (4, '造型吊飾', 350, '靈感來自自然，簡單的點綴，也能傳遞風格與故事。', 52, 0),
    (3, '海島香氛片', 150, '氣味清新宜人，喚醒空間中的輕盈與流動感。', 75, 1),
    (3, '海島香水', 2580, '融合熱帶的濕潤與陽光，留下恰到好處的溫柔存在感。', 37, 1),
    (4, '造型擺件', 1250, '讓空間多一點靈性與質感，捕捉來自島嶼的片刻靜謐。', 69, 1),
    (4, '風景拼圖', 799, '透過拼圖重新感受風景與時間的流動，沉浸於片刻專注。', 94, 1),
    (2, '椰子樹項鍊', 1380, '自然素材的靈感延伸，讓配件也成為生活態度的展現。', 72, 0),
    (1, '海島名產禮盒', 2599, '集結島嶼風土滋味，一盒品嚐節氣與記憶的交融。', 188, 1),
    (2, '波浪耳飾', 999, '低調中帶有律動感，細節讓日常多一點風格選擇。', 57, 1),
    (4, '造型環保杯', 1200, '質感與實用兼備的生活選物，適合攜帶，也適合習慣。', 0, 1),
    (2, '文藝筆記本', 899, '靜靜記錄想法與日常，用書寫延伸對世界的感受與觀察。', 45, 0),
    (2, '青銅指甲刀', 359, '細節展現品味，實用工具也能融入日常的美感。', 68, 1),
    (2, '皮質手錶', 1680, '時間的流動不只被看見，也能被感受與收藏。', 23, 0),
    (2, '原木海島文具套組', 599, '每一件文具都帶有自然的氣息與手感，陪伴創作時光。', 37, 1),
    (2, '透明海濱風景手機殼', 459, '輕柔包覆生活科技，讓日常攜帶多些視覺溫度。', 82, 1),
    (4, '俏皮貼紙套組', 299, '將風景與靈感隨身攜帶，為筆記或生活增添層次與趣味。', 115, 0),
    (2, '珍珠珊瑚文藝髮夾', 799, '柔和氣質與自然元素交織，為造型帶來微妙的情緒變化。', 56, 0),
    (1, '香酥杏仁小魚乾', 150, '鹹香酥脆，是旅途中或辦公時的療癒小食。', 80, 1),
    (1, '清風海鹽檸檬糖', 100, '清新酸甜，如同海風拂面，讓心情慢慢沈澱。', 100, 1),
    (3, '潮汐香氛蠟燭', 880, '點燃片刻寧靜，香氣中蘊藏島嶼記憶與情緒。', 48, 1),
    (3, '漂流木香膏', 680, '便攜香氛的優雅選擇，悄悄留下一道獨特印象。', 61, 1);


-- DROP TABLE IF EXISTS product;


-- 優惠券 coupon （楊捷）
CREATE TABLE coupon (
	coupon_id       INT          AUTO_INCREMENT  PRIMARY KEY,  -- 優惠券編號 (PK)
    coupon_code     VARCHAR(10)  NOT NULL,                     -- 優惠代碼
    discount_value  INT          NOT NULL,                     -- 折扣金額
    min_spend       INT          NOT NULL,                     -- 最低消費金額限制
    start_date      DATE         NOT NULL,                     -- 啟用日期
    end_date        DATE         NOT NULL                      -- 結束日期
);

INSERT INTO coupon (coupon_code, discount_value, min_spend, start_date, end_date)
VALUES ('Tibame', 50, 500, '2025-01-01', '2025-12-31'),
	   ('David', 100, 1000, '2025-05-01', '2025-08-31'),
       ('Summer123', 66, 200, '2025-07-01', '2025-08-31'),
       ('MOM520', 520, 4000, '2025-05-01', '2025-05-31');

-- DROP TABLE IF EXISTS coupon;


-- 商品訂單 product_order （楊捷）
CREATE TABLE product_order (
    product_order_id      INT           AUTO_INCREMENT  PRIMARY KEY,                	-- 訂單編號 (PK)
    member_id             INT           NOT NULL,                                  		-- 會員編號 (FK)
    coupon_id             INT,                                                     		-- 優惠券編號 (FK)
    product_order_amount  INT           NOT NULL,                                  		-- 訂單總金額
    discount_amount       INT           NOT NULL,                                  		-- 折扣金額
    product_paid_amount   INT           NOT NULL,                                  		-- 實際付款金額
    payment_method        TINYINT       NOT NULL  COMMENT '0:信用卡 1:現金付款',     		-- 付款方式
    shipping_method       TINYINT       NOT NULL  COMMENT '0:宅配 1:飯店自取',       		-- 取貨方式
    contact_address       VARCHAR(200)  NOT NULL,                                  		-- 聯絡人地址
    contact_name          VARCHAR(30)   NOT NULL,                                  		-- 聯絡人姓名
    contact_phone         VARCHAR(20)   NOT NULL,                                  		-- 聯絡人電話
    note                  VARCHAR(50)   COMMENT '備註',                           	    -- 訂單備註
    product_order_status  TINYINT       NOT NULL  COMMENT  '0:訂單成立 1:配送中 2:已完成',	-- 商品訂單狀態
    product_order_time    DATETIME      NOT NULL,                                  		-- 商品訂單成立時間

    -- 外來鍵設定
    FOREIGN KEY (member_id) REFERENCES members(member_id),
    FOREIGN KEY (coupon_id) REFERENCES coupon(coupon_id)
);

INSERT INTO product_order (
    member_id, coupon_id, product_order_amount, discount_amount, product_paid_amount,
    payment_method, shipping_method, contact_address, contact_name, contact_phone,
    note, product_order_status, product_order_time
) VALUES
    (1, 1,     1990, 50,  1940, 0, 0, '台北市信義路100號3樓之一', '王小明', '0900000001', '平日下午五點前不在家，請宅配五點後送到謝謝!', 0, '2025-01-11 10:00:00'), -- 買產品1 1個
    (2, 1,     1400, 50,  1350, 1, 0, '台中市西屯路88號',         '林小華', '0900000002', null, 1, '2025-01-31 11:30:00'), -- 買產品2 4個
    (3, NULL,  150,  0,   150,  0, 0, '高雄市中山路99號',         '陳大文', '0900000003', '星期三、四、五固定不在家，包裹送達時間請避開', 2, '2025-02-03 09:15:00'), -- 買產品3 1個
    (4, 1,     999,  50,  949,  1, 0, '新竹市經國路66號',         '張怡君', '0900000004', null, 0, '2025-03-04 14:00:00'), -- 買產品9 1個
    (5, 1,     1200, 50,  1150, 0, 0, '桃園市復興路10號',         '周志強', '0900000005', null, 1, '2025-04-05 16:45:00'), -- 買產品10 1個
    (6, 4,     6858, 520, 6338, 1, 0, '台南市永康區中正街5號',    '蔡美麗', '0900000006', '飯店服務很周到!讚!', 2, '2025-05-01 13:20:00'), -- 買產品5、6、7各2個
    (7, 4,     4100, 520, 3580, 0, 1, '台北市大安區光復南路11號', '何玉芬', '0900000007', null, 0, '2025-05-21 17:10:00'), -- 買產品10 3個、產品2 1個、產品3 1個
    (8, 4,     4500, 520, 3980, 1, 0, '嘉義市博愛路3段77號',      '黃金龍', '0900000008', null, 1, '2025-05-22 12:00:00'), -- 買產品3 30個
    (9, 1,     700,  50,  650,  0, 0, '台中市南區建國南路20號',   '劉阿成', '0900000009', null, 2, '2025-05-24 09:30:00'), -- 買產品3 2個
    (10, NULL, 350,  0,   350,  1, 0, '基隆市安樂區文德路88號',   '楊淑惠', '0900000010', null, 0, '2025-05-25 18:45:00'); -- 買產品2 1個

-- DROP TABLE IF EXISTS product_order;


-- 商品訂單明細 product_order_detail （楊捷）
CREATE TABLE product_order_detail (
    product_order_id        INT           NOT NULL,  -- 訂單編號 (PK, FK)
    product_id              INT           NOT NULL,  -- 商品編號 (PK, FK)
    product_order_name      VARCHAR(20)   NOT NULL,  -- 商品名稱
    product_order_price     INT           NOT NULL,  -- 商品價格
    product_order_quantity  INT           NOT NULL,  -- 商品訂購數量
    CONSTRAINT pk_product_order_id_product_id PRIMARY KEY (product_order_id, product_id),
    -- 外來鍵設定
	FOREIGN KEY (product_order_id) REFERENCES product_order(product_order_id),
	FOREIGN KEY (product_id) REFERENCES product(product_id)
);

INSERT INTO product_order_detail (product_order_id, product_id, product_order_name, product_order_price, product_order_quantity)
VALUES (1,  1, '咖啡禮盒',    1990, 1),
       (2,  2, '造型吊飾',    350,  4),
       (3,  3, '海島香氛片',  150,  1),
       (4,  9, '波浪耳飾',    999,  1),
       (5,  10, '造型環保杯', 1200, 1),
       (6,  5, '造型擺件',    1250, 2),
       (6,  6, '風景拼圖',    799,  2),
       (6,  7, '椰子樹項鍊',  1380, 2),
       (7,  10, '造型環保杯', 1200, 3),
       (7,  2, '造型吊飾',    350,  1),
       (7,  3, '海島香氛片',  150,  1),
       (8,  3, '海島香氛片',  150,  30),
       (9,  3, '海島香氛片',  150,  2),
       (10, 2, '造型吊飾',    350,  1);

-- DROP TABLE IF EXISTS product_order_detail;


-- 會員優惠券對應 member_coupon （楊捷）
CREATE TABLE member_coupon (
    member_id  INT  NOT NULL,                                  -- 會員編號 (PK, FK)
    coupon_id  INT  NOT NULL,                                  -- 優惠券編號 (PK, FK)
    used_date  DATE ,                                          -- 使用日期
    CONSTRAINT pk_member_id_coupon_id PRIMARY KEY (member_id, coupon_id),
    FOREIGN KEY (member_id) REFERENCES members (member_id),
    FOREIGN KEY (coupon_id) REFERENCES coupon (coupon_id)
);

INSERT INTO member_coupon (member_id, coupon_id, used_date)
VALUES (1, 1, '2025-01-11'),
       (2, 1, '2025-01-31'),
       (4, 1, '2025-03-04'),
       (5, 1, '2025-04-05'),
       (6, 4, '2025-05-01'),
       (7, 4, '2025-05-21'),
       (8, 4, '2025-05-22'),
       (9, 1, '2025-05-24');

-- DROP TABLE IF EXISTS member_coupon;


-- 商品圖片 product_photo （陳吟瑄）
CREATE TABLE product_photo (
	product_photo_id	INT			AUTO_INCREMENT	PRIMARY KEY,	-- 商品圖片編號 (PK) (AI)
    product_id			INT			NOT NULL,						-- 商品編號 (FK)
    product_image		LONGBLOB,									-- 商品圖片
    display_order		INT			NOT NULL,						-- 圖片順序
	FOREIGN KEY (product_id) REFERENCES product(product_id)
);

INSERT INTO product_photo (product_id, display_order)
VALUES (1, 0),
       (1, 1),
	   (2, 0),
	   (2, 1),
       (3, 0),
       (4, 0),
       (4, 1),
       (5, 0),
       (6, 0),
       (7, 0),
       (8, 0),
	   (8, 1),
       (9, 0),
       (10, 0),
       (11, 0),
       (12, 0),
       (13, 0),
       (14, 0),
       (15, 0),
       (16, 0),
       (17, 0),
       (18, 0),
       (19, 0),
       (20, 0),
       (21, 0);



-- DROP TABLE IF EXISTS product_photo;


-- 購物車 cart （陳吟瑄）
CREATE TABLE cart (
	member_id                INT       NOT NULL,  -- 會員編號 (PK, FK)
	product_id               INT       NOT NULL,  -- 商品編號 (PK, FK)
	cart_product_quantity    INT       NOT NULL,  -- 購物車內商品數量
	cart_product_price       INT       NOT NULL,  -- 商品當時價格
	cart_exist_time          DATETIME  NOT NULL,  -- 加入購物車時間
	CONSTRAINT pk_member_id_product_id PRIMARY KEY (member_id, product_id),
	FOREIGN KEY (member_id) REFERENCES members(member_id),
	FOREIGN KEY (product_id) REFERENCES product(product_id)
);

INSERT INTO cart (member_id, product_id, cart_product_quantity, cart_product_price, cart_exist_time)
VALUES (7, 1, 5, 1990, '2025-01-08 12:04:57'),
	   (6, 4, 3, 2580, '2025-01-16 13:59:03'),
       (7, 6, 5, 799,  '2025-02-15 17:31:03'),
       (4, 9, 5, 999,  '2025-02-23 12:32:53'),
       (2, 5, 5, 1250, '2025-03-17 23:34:18'),
       (5, 8, 1, 188,  '2025-04-12 07:43:05'),
       (2, 9, 3, 799,  '2025-04-12 20:41:30'),
       (3, 9, 4, 999,  '2025-04-15 23:22:41'),
       (2, 6, 5, 799,  '2025-05-13 17:20:00'),
       (4, 3, 2, 150,  '2025-05-16 19:04:49');

-- DROP TABLE IF EXISTS cart;


/***************************************************************************************************
********************************************* 員工相關 *********************************************
***************************************************************************************************/


-- 部門 department （陳吟瑄）
CREATE TABLE department (
	department_id    INT          AUTO_INCREMENT  PRIMARY KEY,  -- 部門編號 (PK) (AI)
    department_name  VARCHAR(30)  NOT NULL                      -- 部門名稱
);

INSERT INTO department (department_name)
VALUES ('營運部'),
	   ('客服部'),
	   ('接駁部'),
	   ('房務部'),
       ('產品部');
       
-- DROP TABLE IF EXISTS department;


-- 員工 employee （陳吟瑄）
CREATE TABLE employee (
    employee_id				INT				AUTO_INCREMENT	PRIMARY KEY,				-- 員工編號 (PK) (AI)
    department_id			INT				NOT NULL,									-- 部門編號 (FK)
    employee_name			VARCHAR(30)		NOT NULL,									-- 員工姓名
    employee_email			VARCHAR(100)	NOT NULL	UNIQUE,							-- 員工信箱
    employee_address		VARCHAR(200)	NOT NULL,									-- 員工地址
    employee_mobile			VARCHAR(20)		NOT NULL,									-- 員工手機
	employee_password_hash	VARCHAR(100)	NOT NULL,									-- 員工密碼
    employee_gender			TINYINT			NOT NULL	COMMENT '0:男 1:女 2:其它',		-- 員工性別
    employee_birthdate		DATE			NOT NULL,									-- 員工生日
    employee_photo			LONGBLOB,													-- 員工照片
    employee_hiredate		DATE			NOT NULL,									-- 員工到職日
    employee_leavedate		DATE,														-- 員工離職日
    employee_status			TINYINT			NOT NULL	COMMENT '0:離職 1:在職 2:停職',	-- 員工狀態
    FOREIGN KEY (department_id) REFERENCES department(department_id)
);

INSERT INTO employee (department_id, employee_name, employee_email, employee_address, employee_mobile, employee_password_hash, employee_gender, employee_birthdate, employee_hiredate, employee_leavedate, employee_status)
VALUES (1, '管理員',		'admin@tibame.com',			'60413 新營士林路4號9樓',		'0900000101',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '1990-12-30', '2023-01-01', NULL, 1), -- 密碼：asd123456
	   (5, '楊捷',		'jay@tibame.com',			'20869 彰化市育英街12號之0',	'0900000102',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 1, '1978-03-20', '2023-01-15', NULL, 1),
	   (4, '陳薇淨',		'vivian@tibame.com',		'57698 中壢縣龍山寺巷61號8樓',	'0900000103',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '1985-06-28', '2023-02-01', NULL, 1),
	   (5, '陳吟瑄',		'blaire@tibame.com',		'769 白沙民富巷8號4樓',		'0900000104',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '1998-01-11', '2023-02-15', NULL, 1),
	   (4, '詹力臻',		'sandy@tibame.com',			'23008 屏東大橋頭街8號之1',	'0900000105',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '1983-04-27', '2023-03-01', NULL, 1),
	   (4, '曾宸瑩',		'patty@tibame.com',			'965 臺東自由街3號之5',		'0900000106',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '1988-12-07', '2023-03-15', NULL, 1),
	   (3, '賴彥儒',		'lai@tibame.com',			'754 桃園天母街8號7樓',		'0900000107',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 1, '1968-11-08', '2023-04-01', NULL, 1),
	   (3, '王人慶',		'nick@tibame.com',			'479 雲林縣中山巷63號1樓',	'0900000108',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 1, '1978-06-23', '2023-04-15', NULL, 1),
	   (2, '客服員工',	'service@tibame.com',		'729 古坑縣頂福州巷193號之5', 	'0900000109',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '2004-01-17', '2023-05-01', NULL, 1),
	   (2, '停職員工',	'suspension@xiang.com',		'729 古坑縣頂福州巷193號之5',	'0900000110',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '2004-01-17', '2023-05-01', NULL, 2),
	   (2, '離職員工',	'resignation@xiang.com',	'729 古坑縣頂福州巷193號之5',	'0900000111',	'$2b$12$Qn0bN5vspTLVv4LOUtfla.Jm2kLI0vXRngb7817UDSfwHa1W3TqnW', 0, '2004-01-17', '2023-05-01', NULL, 0);

-- DROP TABLE IF EXISTS employee;


-- 權限 permission （陳吟瑄）
CREATE TABLE permission (
	permission_id           INT           AUTO_INCREMENT  PRIMARY KEY,  -- 權限編號 (PK) (AI)
    permission_name         VARCHAR(30)   NOT NULL,                     -- 權限名稱
    permission_description  VARCHAR(100)  NOT NULL                      -- 權限描述
);

INSERT INTO permission (permission_name, permission_description)
VALUES ('operation',	'營運部門權限'),
	   ('service',		'客服部門權限'),
	   ('shuttle',		'接駁部門權限'),
	   ('room',			'房務部門權限'),
	   ('product',		'產品部門權限');
   
-- DROP TABLE IF EXISTS permission;


-- 員工權限對應 employee_permission （陳吟瑄）
CREATE TABLE employee_permission (
	permission_id  INT  NOT NULL,  -- 權限編號 (PK, FK)
	employee_id    INT  NOT NULL,  -- 員工編號 (PK, FK)
    CONSTRAINT pk_permission_id_employee_id PRIMARY KEY (permission_id, employee_id),
    FOREIGN KEY (permission_id) REFERENCES permission(permission_id),
    FOREIGN KEY (employee_id) REFERENCES employee(employee_id)
);

-- 根據員工的部門自動分配對應權限
INSERT INTO employee_permission (permission_id, employee_id)
SELECT p.permission_id, e.employee_id
FROM employee e
JOIN permission p ON p.permission_name = 
    CASE e.department_id
        WHEN 1 THEN 'operation'
        WHEN 2 THEN 'service'
        WHEN 3 THEN 'shuttle'
        WHEN 4 THEN 'room'
        WHEN 5 THEN 'product'
    END
WHERE e.employee_status = 1;

-- 為員工編號01（管理員）添加全部權限
-- 先清除該員工現有的權限
DELETE FROM employee_permission WHERE employee_id = 1;

-- 為員工編號01添加所有權限
INSERT INTO employee_permission (permission_id, employee_id)
SELECT p.permission_id, 1
FROM permission p;

-- DROP TABLE IF EXISTS employee_permission;

-- 操作日誌 operation_log （楊捷）
CREATE TABLE operation_log (
	operation_log_id  INT           AUTO_INCREMENT  PRIMARY KEY,  -- 操作日誌編號 (PK)
    employee_id       INT           NOT NULL,                     -- 員工編號 (FK)
    operation_time    DATETIME      NOT NULL,                     -- 操作日誌時間
    log_description   VARCHAR(100)  NOT NULL,                     -- 操作日誌描述
    FOREIGN KEY (employee_id) REFERENCES employee (employee_id) 
);

INSERT INTO operation_log (employee_id, operation_time, log_description)
VALUES (2, '2025-05-01 09:15:00', '登入系統'),
       (8, '2025-05-01 09:22:00', '登入系統'),
       (8, '2025-05-01 09:30:00', '新增商品資料'),
       (3, '2025-05-01 09:55:00', '登入系統'),
       (3, '2025-05-01 10:00:00', '修改接駁船時段資料'),
       (3, '2025-05-01 10:15:00', '登出系統'),
       (8, '2025-05-01 10:30:00', '新增商品資料'),
       (8, '2025-05-01 11:00:00', '刪除商品資料'),
       (8, '2025-05-01 11:30:00', '登出系統'),
       (2, '2025-05-01 11:30:00', '登出系統'),
       (7, '2025-05-01 12:50:00', '登入系統'),
       (7, '2025-05-01 13:00:00', '修改接駁船座位狀態資料'),
       (5, '2025-05-01 13:25:00', '登入系統'),
       (6, '2025-05-01 13:27:00', '登入系統'),
       (5, '2025-05-01 13:30:00', '新增房間資料'),
       (5, '2025-05-01 13:41:00', '登出系統'),
       (6, '2025-05-01 14:00:00', '新增房間資料'),
       (6, '2025-05-01 14:13:00', '登出系統'),
       (7, '2025-05-01 14:30:00', '刪除接駁船座位狀態資料'),
       (7, '2025-05-01 14:53:00', '登出系統');

-- DROP TABLE IF EXISTS operation_log;


/***************************************************************************************************
********************************************* 其他相關 *********************************************
***************************************************************************************************/


-- 問卷紀錄 feedback （陳薇淨）
CREATE TABLE feedback (
	fb_id				INT			AUTO_INCREMENT,													-- 問卷編號 (PK) (AI)
    room_reservation_id	INT			NOT NULL,														-- 訂單編號 (FK)
    fb_created_at  		DATETIME	NOT NULL DEFAULT CURRENT_TIMESTAMP,								-- 問卷填寫時間
    fb_updated_at 		DATETIME 	DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,			-- 問卷修改時間
    fb_overall_rating	TINYINT		NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 評論星數
	fb_recommend		TINYINT		NOT NULL DEFAULT 1 COMMENT '0:否 1:是',							-- 是否會推薦給親朋好友？
    fb_revisit 			TINYINT 	NOT NULL DEFAULT 1 COMMENT '0:否 1:是',							-- 是否願意再次入住？
    fb_shuttle_rating 	TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 接駁服務滿意度
    fb_reception_rating	TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 櫃台接待滿意度
    fb_room_rating 		TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 客房整潔與舒適度
    fb_facility_rating 	TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 設備與設施滿意度
    fb_env_rating 		TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 飯店環境氛圍
    fb_value_rating 	TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 性價比感受
    fb_website_rating 	TINYINT 	NOT NULL DEFAULT 3 COMMENT '1:一星 2:二星 3:三星 4:四星 5:五星',	-- 網站操作流暢度
    fb_compliment		VARCHAR(1000),																-- 有什麼特別滿意的地方嗎？
    fb_suggestion		VARCHAR(1000),																-- 有什麼地方我們可以改進？
    fb_image			LONGBLOB,																	-- 上傳圖片
	fb_public			TINYINT		NOT NULL DEFAULT 1 COMMENT '0:否 1:是',							-- 是否願意公開評論？
	fb_status			TINYINT		NOT NULL DEFAULT 0 COMMENT '0:下架 1:上架',						-- 評論狀態
    CONSTRAINT	pk_fb_id					PRIMARY KEY(fb_id),
    CONSTRAINT	fk_fb_room_reservation_id	FOREIGN KEY(room_reservation_id)	REFERENCES room_reservation_order(room_reservation_id)
);

INSERT INTO feedback (
    room_reservation_id, fb_created_at, fb_updated_at,
    fb_overall_rating, fb_recommend, fb_revisit,
    fb_shuttle_rating, fb_reception_rating, fb_room_rating,
    fb_facility_rating, fb_env_rating, fb_value_rating, fb_website_rating,
    fb_compliment, fb_suggestion, fb_image, fb_public, fb_status
) VALUES

-- 訂單1：member_id=1，check_out=2024-03-15
(1, '2024-03-15 12:00:00', '2024-03-15 12:00:00',
 5, 1, 1, 5, 5, 5, 5, 5, 5, 4,
'這次入住微嶼 IsleVilla 是我們夫妻第一次的海島渡假體驗，整體從接駁到入住都非常流暢。

尤其是搭乘專屬的接駁船讓我們感覺自己像是尊貴的VIP，服務人員親切貼心，
還提供了小點心。房間面海，夜晚還可以聽到海浪聲，
真的非常療癒，我們一定會再回來！',
NULL, NULL, 1, 1),

-- 訂單2：member_id=4，check_out=2025-05-18
(2, '2025-05-18 12:00:00', '2025-05-18 12:00:00',
 5, 1, 1, 5, 5, 4, 4, 5, 5, 5,
'我選擇在微嶼 IsleVilla 慶祝自己的生日，一切安排都非常完美。
飯店知道是生日還特別在房間準備了小驚喜，這樣的貼心令人非常感動。

雖然只住了一晚，但每一刻都覺得被照顧得很好，推薦給想要度過特別日子的朋友。',
'希望未來可以開放更多元的客房風格，提供不同主題體驗。', NULL, 1, 1),

-- 訂單3：member_id=8，check_out=2025-01-31
(3, '2025-01-31 12:00:00', '2025-01-31 12:00:00',
 5, 1, 1, 5, 5, 5, 5, 5, 4, 5,
'我們一家四口來微嶼 IsleVilla 度寒假，
孩子們超喜歡這裡的沙灘和泳池，玩得不亦樂乎。
爸媽也能好好放鬆，享受陽光與海風。

接駁船服務非常穩定，也讓我們省去了交通煩惱。
推薦給家庭旅遊的朋友，這裡非常適合全家出遊！',
NULL, NULL, 1, 1),

-- 訂單4：member_id=7，check_out=2025-05-22
(4, '2025-05-22 12:00:00', '2025-05-22 12:00:00',
 5, 1, 1, 5, 5, 5, 4, 5, 5, 5,
'這次短暫的微旅行選擇了微嶼 IsleVilla，
從一登上接駁船那刻就有種逃離城市的感覺。

渡假村內部乾淨整潔，植物與建築的設計非常有品味，
讓人一走進就感受到寧靜與放鬆。即使只住一晚，也覺得身心獲得完整的充電。',
'若能在房間內提供更多插座會更方便充電。', NULL, 1, 1),

-- 訂單5：member_id=2，check_out=2025-07-29
(5, '2025-07-29 12:00:00', '2025-07-29 12:00:00',
 5, 1, 1, 5, 5, 5, 5, 5, 5, 4,
'微嶼 IsleVilla 是我近期住過最讓人放鬆的高級渡假村。
不論是硬體設施還是人員服務都維持著高標準，網站訂房也很順利，
資訊清楚、回覆迅速。
感謝你們讓我與另一半度過一個完美假期，期待下次再訪！',
NULL, NULL, 1, 1),
(11, '2025-07-30 10:00:00', '2025-07-30 10:00:00', 5, 1, 1, 4, 5, 5, 4, 5, 5, 4, 
'這次入住微嶼 IsleVilla 是我們夫妻第一次的海島渡假體驗，整體從接駁到入住都非常流暢。
尤其是搭乘專屬的接駁船讓我們感覺自己像是尊貴的VIP，服務人員親切貼心，
還提供了小點心。房間面海，夜晚還可以聽到海浪聲，
真的非常療癒，我們一定會再回來！', NULL, NULL, 1, 1),
(12, '2025-08-01 14:00:00', '2025-08-01 14:00:00', 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, '房間整潔，景觀不錯。', '早餐選項可以再多一點。', NULL, 0, 0),
(13, '2025-09-10 09:30:00', '2025-09-10 09:30:00', 3, 0, 1, 3, 3, 4, 3, 3, 3, 3, NULL, '晚上有點吵雜，希望隔音可以改善。', NULL, 1, 0),
(14, '2025-09-19 11:15:00', '2025-09-19 11:15:00', 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, 
'我選擇在微嶼 IsleVilla 慶祝自己的生日，一切安排都非常完美。
飯店知道是生日還特別在房間準備了小驚喜，這樣的貼心令人非常感動。
雖然只住了一晚，但每一刻都覺得被照顧得很好，推薦給想要度過特別日子的朋友。',
'希望未來可以開放更多元的客房風格，提供不同主題體驗。', NULL, 1, 1),
(15, '2025-10-14 13:00:00', '2025-10-14 13:00:00', 5, 1, 1, 5, 5, 5, 5, 5, 5, 5, '一切都非常完美，是很棒的度假體驗！', NULL, NULL, 1, 0),
(21, '2025-07-09 12:00:00', '2025-07-09 12:00:00', 3, 0, 1, 3, 3, 3, 3, 3, 3, 3, NULL, '網頁操作有點卡，希望優化預約流程。', NULL, 0, 0),
(22, '2025-07-08 09:00:00', '2025-07-08 09:00:00', 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, 
'我們一家四口來微嶼 IsleVilla 度寒假，
孩子們超喜歡這裡的沙灘和泳池，玩得不亦樂乎。
爸媽也能好好放鬆，享受陽光與海風。
接駁船服務非常穩定，也讓我們省去了交通煩惱。
推薦給家庭旅遊的朋友，這裡非常適合全家出遊！', NULL, NULL, 1, 1),
(23, '2025-07-09 16:00:00', '2025-07-09 16:00:00', 3, 0, 0, 3, 4, 3, 3, 3, 3, 3, NULL, '冷氣聲音偏大，建議檢查設備。', NULL, 1, 0),
(24, '2025-07-10 10:30:00', '2025-07-10 10:30:00', 5, 1, 1, 5, 5, 5, 5, 5, 5, 5, '設施新穎，住宿體驗很棒。', NULL, NULL, 1, 1),
(25, '2025-07-10 15:30:00', '2025-07-10 15:30:00', 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, '很適合情侶入住。', NULL, NULL, 0, 0),
(26, '2025-07-07 11:45:00', '2025-07-07 11:45:00', 5, 1, 1, 5, 5, 5, 5, 5, 5, 5, 
'我們一家四口來微嶼IsleVilla度暑假，
孩子們超喜歡這裡的沙灘和泳池，玩得不亦樂乎。
爸媽也能好好放鬆，享受陽光與海風。
接駁船服務非常穩定，也讓我們省去了交通煩惱。
推薦給家庭旅遊的朋友，這裡非常適合全家出遊！', NULL, NULL, 1, 1),
(27, '2025-07-11 09:00:00', '2025-07-11 09:00:00', 3, 0, 0, 3, 3, 3, 3, 3, 3, 3, NULL, '網站使用流程太複雜。', NULL, 1, 0),
(28, '2025-07-09 18:00:00', '2025-07-09 18:00:00', 4, 1, 1, 4, 4, 4, 4, 4, 4, 4, '適合帶小孩入住。', NULL, NULL, 1, 1),
(29, '2025-07-14 08:30:00', '2025-07-14 08:30:00', 4, 1, 1, 3, 4, 4, 3, 4, 4, 3, 
'這次短暫的微旅行選擇了微嶼 IsleVilla，
從一登上接駁船那刻就有種逃離城市的感覺。
渡假村內部乾淨整潔，植物與建築的設計非常有品味，
讓人一走進就感受到寧靜與放鬆。即使只住一晚，也覺得身心獲得完整的充電。',
'若能在房間內提供更多插座會更方便充電。', NULL, 1, 1),
(30, '2025-07-12 17:00:00', '2025-07-12 17:00:00', 3, 0, 0, 3, 3, 3, 3, 3, 3, 3, NULL, '床墊偏軟，睡得不太習慣。', NULL, 0, 0);

-- DROP TABLE IF EXISTS feedback;


-- 最新消息 news （陳薇淨）
CREATE TABLE news(
    news_id				INT				AUTO_INCREMENT,										-- 最新消息編號 (PK) (AI)
    news_title			VARCHAR(20)		NOT NULL,											-- 最新消息標題
    news_content		VARCHAR(1000)	NOT NULL,											-- 最新消息內容
    news_image			LONGBLOB,															-- 最新消息圖片
    news_time			DATETIME		NOT NULL,											-- 最新消息上傳時間
    news_status			TINYINT			NOT NULL	DEFAULT 1	COMMENT '0:下架, 1:上架',	-- 最新消息狀態
    room_promotion_id	INT,            													-- 對應優惠專案
    CONSTRAINT pk_news_id PRIMARY KEY(news_id),
    CONSTRAINT fk_n_room_promotion_id FOREIGN KEY(room_promotion_id) REFERENCES promotion(room_promotion_id)
);

INSERT INTO news (news_title, news_content, news_time, news_status, room_promotion_id)
VALUES 

('冬季旅行計畫推薦', 
'冷冷的冬天，適合來微嶼泡溫泉。

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。

立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-01-05 09:00:00', 1, NULL),

('春假出遊推薦',
'微嶼為您準備了最舒適的住宿空間與溫馨的服務，
無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。

我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
 '2025-03-03 09:00:00', 1, 1),
 
('房客評價破千', 
'感謝支持，我們已累積超過1000則五星好評！
微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。

我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-04-01 18:00:00', 1, NULL),

('免費早餐延長至10點', 
'應顧客建議，即日起早餐供應時間延長至上午10點。
微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。

我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-04-05 07:00:00', 1, NULL),

('兒童遊樂區升級完成', 
'兒童遊樂區已完成升級，歡迎親子同遊！

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。

現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-04-15 12:00:00', 1, NULL),

('泳池維修公告',
'5/10~5/15泳池進行維修，造成不便敬請見諒。

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。

現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-04-25 11:00:00', 1, NULL),

('網站改版通知',
'全新官方網站上線，提供更便捷的訂房體驗！
微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-05-10 10:40:00', 1, NULL),

('暑期優惠開跑',
'指定房型享 85 折優惠。
微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點',
'2025-06-25 00:00:00', 1, 2),

('週年慶活動',
'慶祝開館週年，推出多項感恩回饋。
微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-07-09 00:00:00', 1, 2),

('秋季旅行計畫推薦',
'歡慶中秋佳節，景房限時優惠中。

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、
家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。

立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-09-26 00:00:00', 1, 7),

('週末快閃特惠',
'僅限週末訂房，2025/09/06 至 2025/09/08 優惠開跑！

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、
家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。

現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-09-05 00:00:00', 0, 3),

('限時快閃活動！',
'限時兩天，先搶先贏！

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、
家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。

現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-09-14 00:00:00', 0, 4),

('早鳥優惠開跑',
'提前預訂享雙人房 75 折折扣，優惠至 2025/10/01。
微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、家庭出遊，或是獨自放鬆，都能找到理想選擇。

我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。
現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-09-24 00:00:00', 0, 5),

('中秋促銷限定',
'走過繁忙的一年，是時候讓身心放鬆，來微嶼享受一段靜謐假期。

配合節慶推出主題活動與房型設計，增添更多旅行樂趣。
提供專屬旅遊諮詢、接駁服務與客房送餐，滿足您的所有需求。

歡迎透過官網或電話洽詢，掌握最新優惠資訊。',
'2025-10-03 00:00:00', 0, 6),

('聖誕禮物大放送',
'聖誕節首夜位房型回饋價！

微嶼為您準備了最舒適的住宿空間與溫馨的服務，無論是情侶旅行、
家庭出遊，或是獨自放鬆，都能找到理想選擇。
我們貼心提供多樣化設施，包括溫泉、泳池、親子遊樂區與全天候櫃台，讓您的每一刻都能安心自在。

現在預訂還可享有專屬優惠，不論是平日還是假日，都能以實惠價格體驗高品質假期。
立即規劃您的旅程，讓微嶼成為您美好回憶的起點。',
'2025-12-17 00:00:00', 0, 9),

('元旦住宿優惠開跑',
'走過繁忙的一年，是時候讓身心放鬆，來微嶼享受一段靜謐假期。

每逢假日微嶼皆有驚喜企劃，讓您的假期充滿儀式感。
設有 24 小時櫃台與專屬管家服務，隨時為您解決大小事。

立即規劃假期，讓微嶼陪您度過美好時光。',
'2025-12-24 00:00:00', 1, 10);

-- DROP TABLE IF EXISTS news;


-- 輪播圖片 carousel_photo （陳薇淨）
CREATE TABLE carousel_photo(
	carousel_photo_id  INT       AUTO_INCREMENT,  -- 輪播圖片編號 (PK) (AI)
    carousel_image     LONGBLOB,                  -- 輪播圖片
    CONSTRAINT pk_carousel_photo_id PRIMARY KEY(carousel_photo_id)
);

INSERT INTO carousel_photo ()
VALUES (),
       (),
       (),
       (),
       (),
       (),
       (),
       (),
       (),
       ();

-- DROP TABLE IF EXISTS carousel_photo;


-- 聊天室 (Redis串SQL) chat_room （王人慶）
CREATE TABLE chat_room (
    chat_room_id   INT          AUTO_INCREMENT  PRIMARY KEY  COMMENT '聊天室ID',
    member_id      INT          NOT NULL                     COMMENT '會員ID',
    member_name    VARCHAR(50)  NOT NULL                     COMMENT '會員名稱',
    employee_id    INT                                       COMMENT '員工ID',
    employee_name  VARCHAR(50)                               COMMENT '員工名稱',
    chat_status    TINYINT      NOT NULL        DEFAULT 1    COMMENT '聊天室狀態 1=進行中 0=已結束',

    FOREIGN KEY (member_id) REFERENCES members(member_id),
    FOREIGN KEY (employee_id) REFERENCES employee(employee_id)
);

-- DROP TABLE IF EXISTS chat_room;


-- 聊天訊息 (Redis串SQL) chat_message （王人慶）
CREATE TABLE chat_message (
    message_id        INT            AUTO_INCREMENT  PRIMARY KEY          COMMENT '訊息ID',
    chat_room_id      INT            NOT NULL                             COMMENT '聊天室ID (FK)',
    sender_type       TINYINT        NOT NULL                             COMMENT '發送者類型 0=會員 1=客服',
    sender_id         INT            NOT NULL                             COMMENT '發送者ID',
    sender_name       VARCHAR(50)    NOT NULL                             COMMENT '發送者名稱',
    message_content   VARCHAR(1000)  NOT NULL                             COMMENT '訊息內容',
    is_read           TINYINT        NOT NULL  DEFAULT 0                  COMMENT '是否已讀 0=未讀 1=已讀',
    message_time      DATETIME       NOT NULL  DEFAULT CURRENT_TIMESTAMP  COMMENT '訊息時間',

    FOREIGN KEY (chat_room_id) REFERENCES chat_room(chat_room_id)
);

-- DROP TABLE IF EXISTS chat_message;






















