<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>微嶼 | Isle Villa 後台首頁</title>
<!-- ===== 載入統一樣式 ===== -->
<th:block th:replace="~{fragments/backFragments :: styles}"></th:block>
</head>
<body>
	<!-- ===== 載入 sidebar ===== -->
	<div th:replace="~{fragments/backFragments :: mobileSidebar}"></div>
	<div th:replace="~{fragments/backFragments :: sidebar}"></div>

	<main
		th:replace="~{fragments/backFragments :: mainContent(~{::myContent})}">
		<th:block th:fragment="myContent">
			<!-- //////////////////// 表單內容 //////////////////// -->
			<h1 class="mb-4">✏️ 新增座位可用情況</h1>

			<div class="card shadow-sm border-1 mx-auto"
				style="max-width: 720px;">
				<div class="card-body">
					<form th:action="@{/seatavailability/add}"
						th:object="${seatavailability}" method="post"
						class="needs-validation" novalidate>

						<!-- 接駁日期 -->
						<div class="mb-3">
							<label for="date" class="form-label">接駁日期</label> <input
								type="date" th:field="*{date}" class="form-control" id="date"
								required>
							<div class="invalid-feedback">請選擇日期</div>
						</div>

						<!-- 班次選單 -->
						<div class="mb-3">
							<label for="scheduleId" class="form-label">選擇班次</label> <select
								th:field="*{scheduleId}" class="form-select" id="scheduleId"
								required>
								<option value="" disabled
									th:if="${seatavailability.scheduleId == null}" selected>請選擇班次</option>
								<option th:each="schedule : ${scheduleList}"
									th:value="${schedule.id}"
									th:text="'#' + ${schedule.id} + '｜' + (${schedule.direction == 0 ? '去' : '回'}) + ' - ' + ${#temporals.format(schedule.departureTime, 'HH:mm')} + ' ~ ' + ${#temporals.format(schedule.arrivalTime, 'HH:mm')}">
								</option>
							</select>

							<div class="invalid-feedback">請選擇一個班次</div>
						</div>

						<!-- 可用座位 -->
						<div class="mb-3">
							<label for="seatQuantity" class="form-label">可用座位數</label> <input
								type="number" th:field="*{seatQuantity}" class="form-control"
								id="seatQuantity" min="0" required>
							<div class="invalid-feedback">請輸入可用座位數（不可為負數）</div>
						</div>

						<!-- 按鈕 -->
						<div class="d-flex justify-content-start mt-4">
							<button type="submit" class="btn btn-primary">
							送出
							</button>
							<a th:href="@{/seatavailability/list}"
								class="btn btn-secondary ms-3">取消</a>
						</div>
					</form>
				</div>
			</div>
		</th:block>
	</main>

	<!-- Bootstrap 驗證 JS -->
	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		(() => {
			'use strict';
			const forms = document.querySelectorAll('.needs-validation');
			Array.from(forms).forEach(form => {
				form.addEventListener('submit', event => {
					if (!form.checkValidity()) {
						event.preventDefault();
						event.stopPropagation();
					}
					form.classList.add('was-validated');
				}, false);
			});
		})();
	</script>
</body>
</html>
