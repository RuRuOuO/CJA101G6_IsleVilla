<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>座位狀況列表| 後台管理</title>
<!-- ===== 載入統一樣式 ===== -->
<th:block th:replace="~{fragments/backFragments :: styles}"></th:block>
</head>
<body>
	<!-- ===== 載入 sidebar ===== -->
	<div th:replace="~{fragments/backFragments :: mobileSidebar}"></div>
	<div th:replace="~{fragments/backFragments :: sidebar}"></div>

	<main
		th:replace="~{fragments/backFragments :: mainContent(~{::myContent})}">
		<th:block th:fragment="myContent">
			<!-- //////////////////// 內容開始 //////////////////// -->
			<h1 class="mb-4">💺 座位狀況列表</h1>

			<div class="d-flex align-items-center mb-3">
				<!-- 新增座位按鈕 -->
				<a class="btn btn-primary" th:href="@{/seatavailability/add}"> <i
					class="fa-solid fa-plus text-white me-1"></i>新增座位
				</a>

				<!-- 查詢座位資訊按鈕 -->
				<a class="btn btn-primary ms-2"
					th:href="@{/seatavailability/getseat}"> <i
					class="fa-solid fa-magnifying-glass me-1"></i>查詢座位資訊
				</a>
			</div>

			<div class="table-responsive">
				<table class="table table-bordered text-center align-middle">
					<thead class="table-secondary">
						<tr>
							<th>日期</th>
							<th>時段資訊</th>
							<th>可用座位</th>
							<th>最後更新時間</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="seat : ${seatavailability}">
							<!-- 日期 -->
							<td
								th:text="${#temporals.format(seat.shuttleDate, 'yyyy-MM-dd')}"></td>

							<!-- 時段資訊 -->
							<td
								th:text="${seat.shuttleSchedule != null ?
							    '#' + seat.shuttleSchedule.shuttleScheduleId + '｜' +
							    (seat.shuttleSchedule.shuttleDirection == 0 ? '去' : '回') + ' - ' +
							    #temporals.format(seat.shuttleSchedule.shuttleDepartureTime, 'HH:mm') + ' ~ ' +
							    #temporals.format(seat.shuttleSchedule.shuttleArrivalTime, 'HH:mm') : '未指定'}">
							</td>

							<!-- 可用座位 -->
							<td th:text="${seat.seatQuantity}"></td>

							<!-- 最後更新時間 -->
							<td
								th:text="${seat.seatUpdatedAt != null ? #temporals.format(seat.seatUpdatedAt, 'yyyy-MM-dd HH:mm') : ''}"></td>

							<!-- 操作按鈕 -->
							<td><a class="btn btn-sm btn-primary me-1"
								th:href="@{'/seatavailability/edit/' + ${seat.shuttleScheduleId} + '/' + ${#temporals.format(seat.shuttleDate, 'yyyy-MM-dd')} }">
									<i class="fa-solid fa-pen-to-square me-1"></i>編輯
							</a> <a class="btn btn-sm btn-danger"
								th:href="@{'/seatavailability/delete/' + ${seat.shuttleScheduleId} + '/' + ${#temporals.format(seat.shuttleDate, 'yyyy-MM-dd')} }"
								onclick="return confirm('確定要刪除嗎？');"> <i
									class="fa-solid fa-trash me-1"></i>刪除
							</a></td>
						</tr>
					</tbody>
				</table>
			</div>
			<!-- //////////////////// 內容結束 //////////////////// -->
		</th:block>
	</main>
</body>
</html>
